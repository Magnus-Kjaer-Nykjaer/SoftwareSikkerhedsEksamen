µ
FC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ApiResponse.cs
public 
class 
ApiResponse 
{ 
public 

int 

StatusCode 
{ 
get 
;  
}! "
[ 
JsonProperty 
( 
NullValueHandling #
=$ %
NullValueHandling& 7
.7 8
Ignore8 >
)> ?
]? @
public 

string 
Message 
{ 
get 
;  
}! "
public

 

ApiResponse

 
(

 
int

 

statusCode

 %
)

% &
{ 

StatusCode 
= 

statusCode 
;  
Message 
= *
GetDefaultMessageForStatusCode 0
(0 1

statusCode1 ;
); <
;< =
} 
private 
static 
string *
GetDefaultMessageForStatusCode 8
(8 9
int9 <

statusCode= G
)G H
{ 
return 
	Microsoft 
. 

AspNetCore #
.# $
WebUtilities$ 0
.0 1
ReasonPhrases1 >
.> ?
GetReasonPhrase? N
(N O

statusCodeO Y
)Y Z
;Z [
} 
} Ò•
XC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\AccountController.cs
	namespace		 	
WebGoatCore		
 
.		 
Controllers		 !
{

 
[ 
	Authorize 
] 
public 

class 
AccountController "
:# $

Controller% /
{ 
private 
readonly 
UserManager $
<$ %
IdentityUser% 1
>1 2
_userManager3 ?
;? @
private 
readonly 
SignInManager &
<& '
IdentityUser' 3
>3 4
_signInManager5 C
;C D
private 
readonly 
CustomerRepository +
_customerRepository, ?
;? @
public 
AccountController  
(  !
UserManager! ,
<, -
IdentityUser- 9
>9 :
userManager; F
,F G
SignInManagerH U
<U V
IdentityUserV b
>b c
signInManagerd q
,q r
CustomerRepository	s Ö 
customerRepository
Ü ò
)
ò ô
{ 	
_userManager 
= 
userManager &
;& '
_signInManager 
= 
signInManager *
;* +
_customerRepository 
=  !
customerRepository" 4
;4 5
} 	
[ 	
HttpGet	 
] 
[ 	
AllowAnonymous	 
] 
public 
IActionResult 
Login "
(" #
string# )
?) *
	returnUrl+ 4
)4 5
{ 	
return 
View 
( 
new 
LoginViewModel *
{ 
	ReturnUrl 
= 
	returnUrl %
}   
)   
;   
}!! 	
[## 	
HttpPost##	 
]## 
[$$ 	
AllowAnonymous$$	 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
Login%%) .
(%%. /
LoginViewModel%%/ =
model%%> C
)%%C D
{&& 	
if'' 
('' 
!'' 

ModelState'' 
.'' 
IsValid'' #
)''# $
{(( 
return)) 
View)) 
()) 
model)) !
)))! "
;))" #
}** 
var,, 
result,, 
=,, 
await,, 
_signInManager,, -
.,,- .
PasswordSignInAsync,,. A
(,,A B
model,,B G
.,,G H
Username,,H P
,,,P Q
model,,R W
.,,W X
Password,,X `
,,,` a
model,,b g
.,,g h

RememberMe,,h r
,,,r s
lockoutOnFailure	,,t Ñ
:
,,Ñ Ö
true
,,Ü ä
)
,,ä ã
;
,,ã å
if.. 
(.. 
result.. 
... 
	Succeeded..  
)..  !
{// 
if00 
(00 
model00 
.00 
	ReturnUrl00 #
!=00$ &
null00' +
)00+ ,
{11 
return22 
Redirect22 #
(22# $
model22$ )
.22) *
	ReturnUrl22* 3
)223 4
;224 5
}33 
else44 
{55 
return66 
RedirectToAction66 +
(66+ ,
$str66, 3
,663 4
$str665 ;
)66; <
;66< =
}77 
}88 
if:: 
(:: 
result:: 
.:: 
IsLockedOut:: "
)::" #
{;; 
return<< 
RedirectToPage<< %
(<<% &
$str<<& 1
)<<1 2
;<<2 3
}== 
else>> 
{?? 

ModelState@@ 
.@@ 
AddModelError@@ (
(@@( )
string@@) /
.@@/ 0
Empty@@0 5
,@@5 6
$str@@7 O
)@@O P
;@@P Q
returnAA 
ViewAA 
(AA 
modelAA !
)AA! "
;AA" #
}BB 
}CC 	
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
LogoutEE) /
(EE/ 0
)EE0 1
{FF 	
awaitGG 
_signInManagerGG  
.GG  !
SignOutAsyncGG! -
(GG- .
)GG. /
;GG/ 0
HttpContextHH 
.HH 
SessionHH 
.HH  
SetHH  #
(HH# $
$strHH$ *
,HH* +
newHH, /
CartHH0 4
(HH4 5
)HH5 6
)HH6 7
;HH7 8
returnII 
RedirectToActionII #
(II# $
$strII$ +
,II+ ,
$strII- 3
)II3 4
;II4 5
}JJ 	
[LL 	
HttpGetLL	 
]LL 
[MM 	
AllowAnonymousMM	 
]MM 
publicNN 
asyncNN 
TaskNN 
<NN 
IActionResultNN '
>NN' (
RegisterNN) 1
(NN1 2
)NN2 3
{OO 	
awaitPP 
_signInManagerPP  
.PP  !
SignOutAsyncPP! -
(PP- .
)PP. /
;PP/ 0
returnQQ 
ViewQQ 
(QQ 
newQQ 
RegisterViewModelQQ -
(QQ- .
)QQ. /
)QQ/ 0
;QQ0 1
}RR 	
[TT 	
HttpPostTT	 
]TT 
[UU 	
AllowAnonymousUU	 
]UU 
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (
RegisterVV) 1
(VV1 2
RegisterViewModelVV2 C
modelVVD I
)VVI J
{WW 	
ifXX 
(XX 

ModelStateXX 
.XX 
IsValidXX "
)XX" #
{YY 
varZZ 
userZZ 
=ZZ 
newZZ 
IdentityUserZZ +
(ZZ+ ,
modelZZ, 1
.ZZ1 2
UsernameZZ2 :
)ZZ: ;
{[[ 
Email\\ 
=\\ 
model\\ !
.\\! "
Email\\" '
}]] 
;]] 
var__ 
result__ 
=__ 
await__ "
_userManager__# /
.__/ 0
CreateAsync__0 ;
(__; <
user__< @
,__@ A
model__B G
.__G H
Password__H P
)__P Q
;__Q R
if`` 
(`` 
result`` 
.`` 
	Succeeded`` $
)``$ %
{aa 
_customerRepositorybb '
.bb' (
CreateCustomerbb( 6
(bb6 7
modelbb7 <
.bb< =
CompanyNamebb= H
,bbH I
modelbbJ O
.bbO P
UsernamebbP X
,bbX Y
modelbbZ _
.bb_ `
Addressbb` g
,bbg h
modelbbi n
.bbn o
Citybbo s
,bbs t
modelbbu z
.bbz {
Region	bb{ Å
,
bbÅ Ç
model
bbÉ à
.
bbà â

PostalCode
bbâ ì
,
bbì î
model
bbï ö
.
bbö õ
Country
bbõ ¢
)
bb¢ £
;
bb£ §
awaitdd 
_signInManagerdd (
.dd( )
SignInAsyncdd) 4
(dd4 5
userdd5 9
,dd9 :
isPersistentdd; G
:ddG H
falseddI N
)ddN O
;ddO P
returnee 
RedirectToActionee +
(ee+ ,
$stree, 3
,ee3 4
$stree5 ;
)ee; <
;ee< =
}ff 
foreachhh 
(hh 
varhh 
errorhh "
inhh# %
resulthh& ,
.hh, -
Errorshh- 3
)hh3 4
{ii 

ModelStatejj 
.jj 
AddModelErrorjj ,
(jj, -
stringjj- 3
.jj3 4
Emptyjj4 9
,jj9 :
errorjj; @
.jj@ A
DescriptionjjA L
)jjL M
;jjM N
}kk 
}ll 
returnnn 
Viewnn 
(nn 
modelnn 
)nn 
;nn 
}oo 	
publicqq 
IActionResultqq 
	MyAccountqq &
(qq& '
)qq' (
=>qq) +
Viewqq, 0
(qq0 1
)qq1 2
;qq2 3
publicss 
IActionResultss 
ViewAccountInfoss ,
(ss, -
)ss- .
{tt 	
varuu 
customeruu 
=uu 
_customerRepositoryuu .
.uu. /!
GetCustomerByUsernameuu/ D
(uuD E
_userManageruuE Q
.uuQ R
GetUserNameuuR ]
(uu] ^
Useruu^ b
)uub c
)uuc d
;uud e
ifvv 
(vv 
customervv 
==vv 
nullvv  
)vv  !
{ww 

ModelStatexx 
.xx 
AddModelErrorxx (
(xx( )
stringxx) /
.xx/ 0
Emptyxx0 5
,xx5 6
$strxx7 z
)xxz {
;xx{ |
}yy 
return{{ 
View{{ 
({{ 
customer{{  
){{  !
;{{! "
}|| 	
[~~ 	
HttpGet~~	 
]~~ 
public 
IActionResult 
ChangeAccountInfo .
(. /
)/ 0
{
ÄÄ 	
var
ÅÅ 
customer
ÅÅ 
=
ÅÅ !
_customerRepository
ÅÅ .
.
ÅÅ. /#
GetCustomerByUsername
ÅÅ/ D
(
ÅÅD E
_userManager
ÅÅE Q
.
ÅÅQ R
GetUserName
ÅÅR ]
(
ÅÅ] ^
User
ÅÅ^ b
)
ÅÅb c
)
ÅÅc d
;
ÅÅd e
if
ÇÇ 
(
ÇÇ 
customer
ÇÇ 
==
ÇÇ 
null
ÇÇ  
)
ÇÇ  !
{
ÉÉ 

ModelState
ÑÑ 
.
ÑÑ 
AddModelError
ÑÑ (
(
ÑÑ( )
string
ÑÑ) /
.
ÑÑ/ 0
Empty
ÑÑ0 5
,
ÑÑ5 6
$str
ÑÑ7 z
)
ÑÑz {
;
ÑÑ{ |
return
ÖÖ 
View
ÖÖ 
(
ÖÖ 
new
ÖÖ (
ChangeAccountInfoViewModel
ÖÖ  :
(
ÖÖ: ;
)
ÖÖ; <
)
ÖÖ< =
;
ÖÖ= >
}
ÜÜ 
return
àà 
View
àà 
(
àà 
new
àà (
ChangeAccountInfoViewModel
àà 6
(
àà6 7
)
àà7 8
{
ââ 
CompanyName
ää 
=
ää 
customer
ää &
.
ää& '
CompanyName
ää' 2
,
ää2 3
ContactTitle
ãã 
=
ãã 
customer
ãã '
.
ãã' (
ContactTitle
ãã( 4
,
ãã4 5
Address
åå 
=
åå 
customer
åå "
.
åå" #
Address
åå# *
,
åå* +
City
çç 
=
çç 
customer
çç 
.
çç  
City
çç  $
,
çç$ %
Region
éé 
=
éé 
customer
éé !
.
éé! "
Region
éé" (
,
éé( )

PostalCode
èè 
=
èè 
customer
èè %
.
èè% &

PostalCode
èè& 0
,
èè0 1
Country
êê 
=
êê 
customer
êê "
.
êê" #
Country
êê# *
,
êê* +
}
ëë 
)
ëë 
;
ëë 
}
íí 	
[
îî 	
HttpPost
îî	 
]
îî 
public
ïï 
IActionResult
ïï 
ChangeAccountInfo
ïï .
(
ïï. /(
ChangeAccountInfoViewModel
ïï/ I
model
ïïJ O
)
ïïO P
{
ññ 	
var
óó 
customer
óó 
=
óó !
_customerRepository
óó .
.
óó. /#
GetCustomerByUsername
óó/ D
(
óóD E
_userManager
óóE Q
.
óóQ R
GetUserName
óóR ]
(
óó] ^
User
óó^ b
)
óób c
)
óóc d
;
óód e
if
òò 
(
òò 
customer
òò 
==
òò 
null
òò  
)
òò  !
{
ôô 

ModelState
öö 
.
öö 
AddModelError
öö (
(
öö( )
string
öö) /
.
öö/ 0
Empty
öö0 5
,
öö5 6
$str
öö7 z
)
ööz {
;
öö{ |
return
õõ 
View
õõ 
(
õõ 
model
õõ !
)
õõ! "
;
õõ" #
}
úú 
if
ûû 
(
ûû 

ModelState
ûû 
.
ûû 
IsValid
ûû "
)
ûû" #
{
üü 
customer
†† 
.
†† 
CompanyName
†† $
=
††% &
model
††' ,
.
††, -
CompanyName
††- 8
??
††9 ;
customer
††< D
.
††D E
CompanyName
††E P
;
††P Q
customer
°° 
.
°° 
ContactTitle
°° %
=
°°& '
model
°°( -
.
°°- .
ContactTitle
°°. :
??
°°; =
customer
°°> F
.
°°F G
ContactTitle
°°G S
;
°°S T
customer
¢¢ 
.
¢¢ 
Address
¢¢  
=
¢¢! "
model
¢¢# (
.
¢¢( )
Address
¢¢) 0
??
¢¢1 3
customer
¢¢4 <
.
¢¢< =
Address
¢¢= D
;
¢¢D E
customer
££ 
.
££ 
City
££ 
=
££ 
model
££  %
.
££% &
City
££& *
??
££+ -
customer
££. 6
.
££6 7
City
££7 ;
;
££; <
customer
§§ 
.
§§ 
Region
§§ 
=
§§  !
model
§§" '
.
§§' (
Region
§§( .
??
§§/ 1
customer
§§2 :
.
§§: ;
Region
§§; A
;
§§A B
customer
•• 
.
•• 

PostalCode
•• #
=
••$ %
model
••& +
.
••+ ,

PostalCode
••, 6
??
••7 9
customer
••: B
.
••B C

PostalCode
••C M
;
••M N
customer
¶¶ 
.
¶¶ 
Country
¶¶  
=
¶¶! "
model
¶¶# (
.
¶¶( )
Country
¶¶) 0
??
¶¶1 3
customer
¶¶4 <
.
¶¶< =
Country
¶¶= D
;
¶¶D E!
_customerRepository
ßß #
.
ßß# $
SaveCustomer
ßß$ 0
(
ßß0 1
customer
ßß1 9
)
ßß9 :
;
ßß: ;
model
©© 
.
©©  
UpdatedSucessfully
©© (
=
©©) *
true
©©+ /
;
©©/ 0
}
™™ 
return
¨¨ 
View
¨¨ 
(
¨¨ 
model
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 	
[
ØØ 	
HttpGet
ØØ	 
]
ØØ 
public
∞∞ 
IActionResult
∞∞ 
ChangePassword
∞∞ +
(
∞∞+ ,
)
∞∞, -
=>
∞∞. 0
View
∞∞1 5
(
∞∞5 6
new
∞∞6 9%
ChangePasswordViewModel
∞∞: Q
(
∞∞Q R
)
∞∞R S
)
∞∞S T
;
∞∞T U
[
≤≤ 	
HttpPost
≤≤	 
]
≤≤ 
public
≥≥ 
async
≥≥ 
Task
≥≥ 
<
≥≥ 
IActionResult
≥≥ '
>
≥≥' (
ChangePassword
≥≥) 7
(
≥≥7 8%
ChangePasswordViewModel
≥≥8 O
model
≥≥P U
)
≥≥U V
{
¥¥ 	
if
µµ 
(
µµ 

ModelState
µµ 
.
µµ 
IsValid
µµ "
)
µµ" #
{
∂∂ 
var
∑∑ 
result
∑∑ 
=
∑∑ 
await
∑∑ "
_userManager
∑∑# /
.
∑∑/ 0!
ChangePasswordAsync
∑∑0 C
(
∑∑C D
await
∑∑D I
_userManager
∑∑J V
.
∑∑V W
GetUserAsync
∑∑W c
(
∑∑c d
User
∑∑d h
)
∑∑h i
,
∑∑i j
model
∑∑k p
.
∑∑p q
OldPassword
∑∑q |
,
∑∑| }
model∑∑~ É
.∑∑É Ñ
NewPassword∑∑Ñ è
)∑∑è ê
;∑∑ê ë
if
∏∏ 
(
∏∏ 
result
∏∏ 
.
∏∏ 
	Succeeded
∏∏ $
)
∏∏$ %
{
ππ 
return
∫∫ 
View
∫∫ 
(
∫∫  
$str
∫∫  7
)
∫∫7 8
;
∫∫8 9
}
ªª 
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ 
error
ΩΩ "
in
ΩΩ# %
result
ΩΩ& ,
.
ΩΩ, -
Errors
ΩΩ- 3
)
ΩΩ3 4
{
ææ 

ModelState
øø 
.
øø 
AddModelError
øø ,
(
øø, -
string
øø- 3
.
øø3 4
Empty
øø4 9
,
øø9 :
error
øø; @
.
øø@ A
Description
øøA L
)
øøL M
;
øøM N
}
¿¿ 
}
¡¡ 
return
√√ 
View
√√ 
(
√√ 
model
√√ 
)
√√ 
;
√√ 
}
ƒƒ 	
[
∆∆ 	
HttpGet
∆∆	 
]
∆∆ 
public
«« 
IActionResult
«« 
AddUserTemp
«« (
(
««( )
)
««) *
{
»» 	
var
…… 
model
…… 
=
…… 
new
…… "
AddUserTempViewModel
…… 0
{
   
IsIssuerAdmin
ÀÀ 
=
ÀÀ 
User
ÀÀ  $
.
ÀÀ$ %
IsInRole
ÀÀ% -
(
ÀÀ- .
$str
ÀÀ. 5
)
ÀÀ5 6
,
ÀÀ6 7
}
ÃÃ 
;
ÃÃ 
return
ÕÕ 
View
ÕÕ 
(
ÕÕ 
model
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
ŒŒ 	
[
–– 	
HttpPost
––	 
]
–– 
public
—— 
async
—— 
Task
—— 
<
—— 
IActionResult
—— '
>
——' (
AddUserTemp
——) 4
(
——4 5"
AddUserTempViewModel
——5 I
model
——J O
)
——O P
{
““ 	
if
”” 
(
”” 
!
”” 
model
”” 
.
”” 
IsIssuerAdmin
”” #
)
””# $
{
‘‘ 
return
’’ 
RedirectToAction
’’ '
(
’’' (
$str
’’( /
)
’’/ 0
;
’’0 1
}
÷÷ 
if
ÿÿ 
(
ÿÿ 

ModelState
ÿÿ 
.
ÿÿ 
IsValid
ÿÿ "
)
ÿÿ" #
{
ŸŸ 
var
⁄⁄ 
user
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
IdentityUser
⁄⁄ +
(
⁄⁄+ ,
model
⁄⁄, 1
.
⁄⁄1 2
NewUsername
⁄⁄2 =
)
⁄⁄= >
{
€€ 
Email
‹‹ 
=
‹‹ 
model
‹‹ !
.
‹‹! "
NewEmail
‹‹" *
}
›› 
;
›› 
var
ﬂﬂ 
result
ﬂﬂ 
=
ﬂﬂ 
await
ﬂﬂ "
_userManager
ﬂﬂ# /
.
ﬂﬂ/ 0
CreateAsync
ﬂﬂ0 ;
(
ﬂﬂ; <
user
ﬂﬂ< @
,
ﬂﬂ@ A
model
ﬂﬂB G
.
ﬂﬂG H
NewPassword
ﬂﬂH S
)
ﬂﬂS T
;
ﬂﬂT U
if
‡‡ 
(
‡‡ 
result
‡‡ 
.
‡‡ 
	Succeeded
‡‡ $
)
‡‡$ %
{
·· 
if
‚‚ 
(
‚‚ 
model
‚‚ 
.
‚‚ 
MakeNewUserAdmin
‚‚ .
)
‚‚. /
{
„„ 
result
ÂÂ 
=
ÂÂ  
await
ÂÂ! &
_userManager
ÂÂ' 3
.
ÂÂ3 4
AddToRoleAsync
ÂÂ4 B
(
ÂÂB C
user
ÂÂC G
,
ÂÂG H
$str
ÂÂI P
)
ÂÂP Q
;
ÂÂQ R
if
ÊÊ 
(
ÊÊ 
!
ÊÊ 
result
ÊÊ #
.
ÊÊ# $
	Succeeded
ÊÊ$ -
)
ÊÊ- .
{
ÁÁ 
foreach
ËË #
(
ËË$ %
var
ËË% (
error
ËË) .
in
ËË/ 1
result
ËË2 8
.
ËË8 9
Errors
ËË9 ?
)
ËË? @
{
ÈÈ 

ModelState
ÍÍ  *
.
ÍÍ* +
AddModelError
ÍÍ+ 8
(
ÍÍ8 9
string
ÍÍ9 ?
.
ÍÍ? @
Empty
ÍÍ@ E
,
ÍÍE F
error
ÍÍG L
.
ÍÍL M
Description
ÍÍM X
)
ÍÍX Y
;
ÍÍY Z
}
ÎÎ 
}
ÏÏ 
}
ÌÌ 
}
ÓÓ 
else
ÔÔ 
{
 
foreach
ÒÒ 
(
ÒÒ 
var
ÒÒ  
error
ÒÒ! &
in
ÒÒ' )
result
ÒÒ* 0
.
ÒÒ0 1
Errors
ÒÒ1 7
)
ÒÒ7 8
{
ÚÚ 

ModelState
ÛÛ "
.
ÛÛ" #
AddModelError
ÛÛ# 0
(
ÛÛ0 1
string
ÛÛ1 7
.
ÛÛ7 8
Empty
ÛÛ8 =
,
ÛÛ= >
error
ÛÛ? D
.
ÛÛD E
Description
ÛÛE P
)
ÛÛP Q
;
ÛÛQ R
}
ÙÙ 
}
ıı 
}
ˆˆ 
model
¯¯ 
.
¯¯ 
CreatedUser
¯¯ 
=
¯¯ 
true
¯¯  $
;
¯¯$ %
return
˘˘ 
View
˘˘ 
(
˘˘ 
model
˘˘ 
)
˘˘ 
;
˘˘ 
}
˙˙ 	
}
˚˚ 
}¸¸ ÷#
UC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\BlogController.cs
	namespace 	
WebGoatCore
 
. 
Controllers !
{ 
[		 
Route		 

(		
 
$str		 "
)		" #
]		# $
public

 

class

 
BlogController

 
:

  !

Controller

" ,
{ 
private 
readonly 
BlogEntryRepository , 
_blogEntryRepository- A
;A B
private 
readonly "
BlogResponseRepository /#
_blogResponseRepository0 G
;G H
public 
BlogController 
( 
BlogEntryRepository 1
blogEntryRepository2 E
,E F"
BlogResponseRepositoryG ]"
blogResponseRepository^ t
,t u
NorthwindContext	v Ü
context
á é
)
é è
{ 	 
_blogEntryRepository  
=! "
blogEntryRepository# 6
;6 7#
_blogResponseRepository #
=$ %"
blogResponseRepository& <
;< =
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
(  
_blogEntryRepository ,
., -
GetTopBlogEntries- >
(> ?
)? @
)@ A
;A B
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
IActionResult 
Reply "
(" #
int# &
entryId' .
). /
{ 	
return 
View 
(  
_blogEntryRepository ,
., -
GetBlogEntry- 9
(9 :
entryId: A
)A B
)B C
;C D
} 	
[   	
HttpPost  	 
(   
$str   
)   
]   
public!! 
IActionResult!! 
Reply!! "
(!!" #
int!!# &
entryId!!' .
,!!. /
string!!0 6
contents!!7 ?
)!!? @
{"" 	
var## 
userName## 
=## 
User## 
?##  
.##  !
Identity##! )
?##) *
.##* +
Name##+ /
??##0 2
$str##3 >
;##> ?
var$$ 
response$$ 
=$$ 
new$$ 
BlogResponse$$ +
($$+ ,
)$$, -
{%% 
Author&& 
=&& 
userName&& !
,&&! "
Contents'' 
='' 
contents'' #
,''# $
BlogEntryId(( 
=(( 
entryId(( %
,((% &
ResponseDate)) 
=)) 
DateTime)) '
.))' (
Now))( +
}** 
;** #
_blogResponseRepository++ #
.++# $
CreateBlogResponse++$ 6
(++6 7
response++7 ?
)++? @
;++@ A
return-- 
RedirectToAction-- #
(--# $
$str--$ +
)--+ ,
;--, -
}.. 	
[00 	
HttpGet00	 
]00 
[11 	
	Authorize11	 
(11 
Roles11 
=11 
$str11 "
)11" #
]11# $
public22 
IActionResult22 
Create22 #
(22# $
)22$ %
=>22& (
View22) -
(22- .
)22. /
;22/ 0
[44 	
HttpPost44	 
]44 
[55 	
	Authorize55	 
(55 
Roles55 
=55 
$str55 "
)55" #
]55# $
public66 
IActionResult66 
Create66 #
(66# $
string66$ *
title66+ 0
,660 1
string662 8
contents669 A
)66A B
{77 	
var88 
	blogEntry88 
=88  
_blogEntryRepository88 0
.880 1
CreateBlogEntry881 @
(88@ A
title88A F
,88F G
contents88H P
,88P Q
User88R V
!88V W
.88W X
Identity88X `
!88` a
.88a b
Name88b f
!88f g
)88g h
;88h i
return99 
View99 
(99 
	blogEntry99 !
)99! "
;99" #
}:: 	
}<< 
}== ‚2
UC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\CartController.cs
	namespace 	
WebGoatCore
 
. 
Controllers !
{ 
[ 
Route 

(
 
$str "
)" #
]# $
public		 

class		 
CartController		 
:		  !

Controller		" ,
{

 
private 
readonly 
ProductRepository *
_productRepository+ =
;= >
public 
CartController 
( 
ProductRepository /
productRepository0 A
)A B
{ 	
_productRepository 
=  
productRepository! 2
;2 3
} 	
private 
Cart 
GetCart 
( 
) 
{ 	
HttpContext 
. 
Session 
.  
TryGet  &
<& '
Cart' +
>+ ,
(, -
$str- 3
,3 4
out5 8
var9 <
cart= A
)A B
;B C
if 
( 
cart 
== 
null 
) 
{ 
cart 
= 
new 
Cart 
(  
)  !
;! "
} 
return 
cart 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
GetCart 
(  
)  !
)! "
;" #
} 	
[!! 	
HttpPost!!	 
(!! 
$str!! 
)!!  
]!!  !
public"" 
IActionResult"" 
AddOrder"" %
(""% &
int""& )
	productId""* 3
,""3 4
short""5 :
quantity""; C
)""C D
{## 	
if$$ 
($$ 
quantity$$ 
<=$$ 
$num$$ 
)$$ 
{%% 
return&& 
RedirectToAction&& '
(&&' (
$str&&( 1
,&&1 2
$str&&3 <
,&&< =
new&&> A
{&&B C
	productId&&D M
=&&N O
	productId&&P Y
,&&Y Z
quantity&&[ c
=&&d e
quantity&&f n
}&&o p
)&&p q
;&&q r
}'' 
var)) 
product)) 
=)) 
_productRepository)) ,
.)), -
GetProductById))- ;
()); <
	productId))< E
)))E F
;))F G
var++ 
cart++ 
=++ 
GetCart++ 
(++ 
)++  
;++  !
if,, 
(,, 
!,, 
cart,, 
.,, 
OrderDetails,, !
.,,! "
ContainsKey,," -
(,,- .
	productId,,. 7
),,7 8
),,8 9
{-- 
var.. 
orderDetail.. 
=..  !
new.." %
OrderDetail..& 1
(..1 2
)..2 3
{// 
Discount00 
=00 
$num00 #
,00# $
	ProductId11 
=11 
	productId11  )
,11) *
Quantity22 
=22 
quantity22 '
,22' (
Product33 
=33 
product33 %
,33% &
	UnitPrice44 
=44 
product44  '
.44' (
	UnitPrice44( 1
}55 
;55 
cart66 
.66 
OrderDetails66 !
.66! "
Add66" %
(66% &
orderDetail66& 1
.661 2
	ProductId662 ;
,66; <
orderDetail66= H
)66H I
;66I J
}77 
else88 
{99 
var:: 
originalOrder:: !
=::" #
cart::$ (
.::( )
OrderDetails::) 5
[::5 6
	productId::6 ?
]::? @
;::@ A
originalOrder;; 
.;; 
Quantity;; &
+=;;' )
quantity;;* 2
;;;2 3
}<< 
HttpContext>> 
.>> 
Session>> 
.>>  
Set>>  #
(>># $
$str>>$ *
,>>* +
cart>>, 0
)>>0 1
;>>1 2
return@@ 
RedirectToAction@@ #
(@@# $
$str@@$ +
)@@+ ,
;@@, -
}AA 	
[CC 	
HttpGetCC	 
(CC 
$strCC 
)CC 
]CC  
publicDD 
IActionResultDD 
RemoveOrderDD (
(DD( )
intDD) ,
	productIdDD- 6
)DD6 7
{EE 	
tryFF 
{GG 
varHH 
cartHH 
=HH 
GetCartHH "
(HH" #
)HH# $
;HH$ %
ifII 
(II 
!II 
cartII 
.II 
OrderDetailsII &
.II& '
ContainsKeyII' 2
(II2 3
	productIdII3 <
)II< =
)II= >
{JJ 
returnKK 
ViewKK 
(KK  
$strKK  2
,KK2 3
stringKK4 :
.KK: ;
FormatKK; A
(KKA B
$strKKB k
,KKk l
	productIdKKm v
)KKv w
)KKw x
;KKx y
}LL 
cartNN 
.NN 
OrderDetailsNN !
.NN! "
RemoveNN" (
(NN( )
	productIdNN) 2
)NN2 3
;NN3 4
HttpContextOO 
.OO 
SessionOO #
.OO# $
SetOO$ '
(OO' (
$strOO( .
,OO. /
cartOO0 4
)OO4 5
;OO5 6
ResponseQQ 
.QQ 
RedirectQQ !
(QQ! "
$strQQ" 3
)QQ3 4
;QQ4 5
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 
returnUU 
ViewUU 
(UU 
$strUU .
,UU. /
stringUU0 6
.UU6 7
FormatUU7 =
(UU= >
$strUU> Z
,UUZ [
exUU\ ^
.UU^ _
MessageUU_ f
)UUf g
)UUg h
;UUh i
}VV 
returnXX 
RedirectToActionXX #
(XX# $
$strXX$ +
)XX+ ,
;XX, -
}YY 	
}ZZ 
}[[ ¶©
YC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\CheckoutController.cs
	namespace 	
WebGoatCore
 
. 
Controllers !
{ 
public 

class 
CheckoutController #
:$ %

Controller& 0
{ 
private 
readonly 
UserManager $
<$ %
IdentityUser% 1
>1 2
_userManager3 ?
;? @
private 
readonly 
CustomerRepository +
_customerRepository, ?
;? @
private 
readonly 
ShipperRepository *
_shipperRepository+ =
;= >
private 
readonly 
OrderRepository (
_orderRepository) 9
;9 :
private 
CheckoutViewModel !
?! "
_model# )
;) *
private 
string 
_resourcePath $
;$ %
public 
CheckoutController !
(! "
UserManager" -
<- .
IdentityUser. :
>: ;
userManager< G
,G H
CustomerRepositoryI [
customerRepository\ n
,n o
IHostEnvironment	p Ä
hostEnvironment
Å ê
,
ê ë
IConfiguration
í †
configuration
° Æ
,
Æ Ø
ShipperRepository
∞ ¡
shipperRepository
¬ ”
,
” ‘
OrderRepository
’ ‰
orderRepository
Â Ù
)
Ù ı
{ 	
_userManager 
= 
userManager &
;& '
_customerRepository 
=  !
customerRepository" 4
;4 5
_shipperRepository 
=  
shipperRepository! 2
;2 3
_orderRepository 
= 
orderRepository .
;. /
_resourcePath 
= 
configuration )
.) *
GetValue* 2
(2 3
	Constants3 <
.< =
WEBGOAT_ROOT= I
,I J
hostEnvironmentK Z
.Z [
ContentRootPath[ j
)j k
;k l
}   	
["" 	
HttpGet""	 
]"" 
public## 
IActionResult## 
Checkout## %
(##% &
)##& '
{$$ 	
if%% 
(%% 
_model%% 
==%% 
null%% 
)%% 
{&& 
InitializeModel'' 
(''  
)''  !
;''! "
}(( 
return** 
View** 
(** 
_model** 
)** 
;**  
}++ 	
private-- 
void-- 
InitializeModel-- $
(--$ %
)--% &
{.. 	
_model// 
=// 
new// 
CheckoutViewModel// *
(//* +
)//+ ,
;//, -
_model11 
.11 
Cart11 
=11 
HttpContext11 %
.11% &
Session11& -
.11- .
Get11. 1
<111 2
Cart112 6
>116 7
(117 8
$str118 >
)11> ?
;11? @
_model22 
.22 $
AvailableExpirationYears22 +
=22, -

Enumerable22. 8
.228 9
Range229 >
(22> ?
$num22? @
,22@ A
$num22B C
)22C D
.22D E
Select22E K
(22K L
i22L M
=>22N P
DateTime22Q Y
.22Y Z
Now22Z ]
.22] ^
Year22^ b
+22c d
i22e f
)22f g
.22g h
ToList22h n
(22n o
)22o p
;22p q
_model33 
.33 
ShippingOptions33 "
=33# $
_shipperRepository33% 7
.337 8
GetShippingOptions338 J
(33J K
_model33K Q
.33Q R
Cart33R V
?33V W
.33W X
SubTotal33X `
??33a c
$num33d e
)33e f
;33f g
if55 
(55 
_model55 
.55 
Cart55 
==55 
null55 #
||55$ &
_model55' -
.55- .
Cart55. 2
.552 3
OrderDetails553 ?
.55? @
Count55@ E
==55F H
$num55I J
)55J K
{66 

ModelState77 
.77 
AddModelError77 (
(77( )
string77) /
.77/ 0
Empty770 5
,775 6
$str777 X
)77X Y
;77Y Z
}88 
var:: 
customer:: 
=:: !
GetCustomerOrAddError:: 0
(::0 1
)::1 2
;::2 3
if;; 
(;; 
customer;; 
!=;; 
null;;  
);;  !
{<< 
var== 

creditCard== 
===   
GetCreditCardForUser==! 5
(==5 6
)==6 7
;==7 8

creditCard?? 
.?? 
GetCardForUser?? )
(??) *
)??* +
;??+ ,
_model@@ 
.@@ 

CreditCard@@ !
=@@" #

creditCard@@$ .
.@@. /
Number@@/ 5
;@@5 6
_modelAA 
.AA 
ExpirationMonthAA &
=AA' (

creditCardAA) 3
.AA3 4
ExpiryAA4 :
.AA: ;
MonthAA; @
;AA@ A
_modelBB 
.BB 
ExpirationYearBB %
=BB& '

creditCardBB( 2
.BB2 3
ExpiryBB3 9
.BB9 :
YearBB: >
;BB> ?
_modelDD 
.DD 

ShipTargetDD !
=DD" #
customerDD$ ,
.DD, -
CompanyNameDD- 8
;DD8 9
_modelEE 
.EE 
AddressEE 
=EE  
customerEE! )
.EE) *
AddressEE* 1
??EE2 4
stringEE5 ;
.EE; <
EmptyEE< A
;EEA B
_modelFF 
.FF 
CityFF 
=FF 
customerFF &
.FF& '
CityFF' +
??FF, .
stringFF/ 5
.FF5 6
EmptyFF6 ;
;FF; <
_modelGG 
.GG 
RegionGG 
=GG 
customerGG  (
.GG( )
RegionGG) /
??GG0 2
stringGG3 9
.GG9 :
EmptyGG: ?
;GG? @
_modelHH 
.HH 

PostalCodeHH !
=HH" #
customerHH$ ,
.HH, -

PostalCodeHH- 7
??HH8 :
stringHH; A
.HHA B
EmptyHHB G
;HHG H
_modelII 
.II 
CountryII 
=II  
customerII! )
.II) *
CountryII* 1
??II2 4
stringII5 ;
.II; <
EmptyII< A
;IIA B
}JJ 
}KK 	
[MM 	
HttpPostMM	 
]MM 
publicNN 
IActionResultNN 
CheckoutNN %
(NN% &
CheckoutViewModelNN& 7
modelNN8 =
)NN= >
{OO 	
modelPP 
.PP 
CartPP 
=PP 
HttpContextPP $
.PP$ %
SessionPP% ,
.PP, -
GetPP- 0
<PP0 1
CartPP1 5
>PP5 6
(PP6 7
$strPP7 =
)PP= >
!PP> ?
;PP? @
varRR 
customerRR 
=RR !
GetCustomerOrAddErrorRR 0
(RR0 1
)RR1 2
;RR2 3
ifSS 
(SS 
customerSS 
==SS 
nullSS 
)SS  
{TT 
returnUU 
ViewUU 
(UU 
modelUU !
)UU! "
;UU" #
}VV 
varXX 

creditCardXX 
=XX  
GetCreditCardForUserXX 1
(XX1 2
)XX2 3
;XX3 4
tryYY 
{ZZ 

creditCard[[ 
.[[ 
GetCardForUser[[ )
([[) *
)[[* +
;[[+ ,
}\\ 
catch]] 
(]] .
"WebGoatCreditCardNotFoundException]] 5
)]]5 6
{^^ 
}__ 
ifcc 
(cc 
modelcc 
.cc 

CreditCardcc  
!=cc! #
nullcc$ (
&&cc) +
modelcc, 1
.cc1 2

CreditCardcc2 <
.cc< =
Lengthcc= C
>=ccD F
$numccG I
)ccI J
{dd 

creditCardee 
.ee 
Numberee !
=ee" #
modelee$ )
.ee) *

CreditCardee* 4
;ee4 5

creditCardff 
.ff 
Expiryff !
=ff" #
newff$ '
DateTimeff( 0
(ff0 1
modelff1 6
.ff6 7
ExpirationYearff7 E
,ffE F
modelffG L
.ffL M
ExpirationMonthffM \
,ff\ ]
$numff^ _
)ff_ `
;ff` a
}gg 
elsehh 
{ii 

ModelStatejj 
.jj 
AddModelErrorjj (
(jj( )
stringjj) /
.jj/ 0
Emptyjj0 5
,jj5 6
$strjj7 `
)jj` a
;jja b
_modelkk 
=kk 
modelkk 
;kk 
returnll 
Viewll 
(ll 
_modelll "
)ll" #
;ll# $
}mm 
ifpp 
(pp 
!pp 

creditCardpp 
.pp 
IsValidpp #
(pp# $
)pp$ %
)pp% &
{qq 

ModelStaterr 
.rr 
AddModelErrorrr (
(rr( )
stringrr) /
.rr/ 0
Emptyrr0 5
,rr5 6
$strrr7 k
)rrk l
;rrl m
_modelss 
=ss 
modelss 
;ss 
returntt 
Viewtt 
(tt 
_modeltt "
)tt" #
;tt# $
}uu 
ifww 
(ww 
modelww 
.ww 
RememberCreditCardww (
)ww( )
{xx 

creditCardyy 
.yy 
SaveCardForUseryy *
(yy* +
)yy+ ,
;yy, -
}zz 
var|| 
order|| 
=|| 
new|| 
Order|| !
{}} 
ShipVia~~ 
=~~ 
model~~ 
.~~  
ShippingMethod~~  .
,~~. /
ShipName 
= 
model  
.  !

ShipTarget! +
,+ ,
ShipAddress
ÄÄ 
=
ÄÄ 
model
ÄÄ #
.
ÄÄ# $
Address
ÄÄ$ +
,
ÄÄ+ ,
ShipCity
ÅÅ 
=
ÅÅ 
model
ÅÅ  
.
ÅÅ  !
City
ÅÅ! %
,
ÅÅ% &

ShipRegion
ÇÇ 
=
ÇÇ 
model
ÇÇ "
.
ÇÇ" #
Region
ÇÇ# )
,
ÇÇ) *
ShipPostalCode
ÉÉ 
=
ÉÉ  
model
ÉÉ! &
.
ÉÉ& '

PostalCode
ÉÉ' 1
,
ÉÉ1 2
ShipCountry
ÑÑ 
=
ÑÑ 
model
ÑÑ #
.
ÑÑ# $
Country
ÑÑ$ +
,
ÑÑ+ ,
OrderDetails
ÖÖ 
=
ÖÖ 
model
ÖÖ $
.
ÖÖ$ %
Cart
ÖÖ% )
.
ÖÖ) *
OrderDetails
ÖÖ* 6
.
ÖÖ6 7
Values
ÖÖ7 =
.
ÖÖ= >
ToList
ÖÖ> D
(
ÖÖD E
)
ÖÖE F
,
ÖÖF G

CustomerId
ÜÜ 
=
ÜÜ 
customer
ÜÜ %
.
ÜÜ% &

CustomerId
ÜÜ& 0
,
ÜÜ0 1
	OrderDate
áá 
=
áá 
DateTime
áá $
.
áá$ %
Now
áá% (
,
áá( )
RequiredDate
àà 
=
àà 
DateTime
àà '
.
àà' (
Now
àà( +
.
àà+ ,
AddDays
àà, 3
(
àà3 4
$num
àà4 5
)
àà5 6
,
àà6 7
Freight
ââ 
=
ââ 
Math
ââ 
.
ââ 
Round
ââ $
(
ââ$ % 
_shipperRepository
ââ% 7
.
ââ7 8#
GetShipperByShipperId
ââ8 M
(
ââM N
model
ââN S
.
ââS T
ShippingMethod
ââT b
)
ââb c
.
ââc d
GetShippingCost
ââd s
(
ââs t
model
âât y
.
âây z
Cart
ââz ~
.
ââ~ 
SubTotalââ á
)ââá à
,ââà â
$numââä ã
)ââã å
,ââå ç

EmployeeId
ää 
=
ää 
$num
ää 
,
ää 
}
ãã 
;
ãã 
var
çç 
approvalCode
çç 
=
çç 

creditCard
çç )
.
çç) *

ChargeCard
çç* 4
(
çç4 5
order
çç5 :
.
çç: ;
Total
çç; @
)
çç@ A
;
ççA B
order
èè 
.
èè 
Shipment
èè 
=
èè 
new
èè  
Shipment
èè! )
(
èè) *
)
èè* +
{
êê 
ShipmentDate
ëë 
=
ëë 
DateTime
ëë '
.
ëë' (
Today
ëë( -
.
ëë- .
AddDays
ëë. 5
(
ëë5 6
$num
ëë6 7
)
ëë7 8
,
ëë8 9
	ShipperId
íí 
=
íí 
order
íí !
.
íí! "
ShipVia
íí" )
,
íí) *
TrackingNumber
ìì 
=
ìì   
_shipperRepository
ìì! 3
.
ìì3 4#
GetNextTrackingNumber
ìì4 I
(
ììI J 
_shipperRepository
ììJ \
.
ìì\ ]#
GetShipperByShipperId
ìì] r
(
ììr s
order
ììs x
.
ììx y
ShipViaììy Ä
)ììÄ Å
)ììÅ Ç
,ììÇ É
}
îî 
;
îî 
var
óó 
orderId
óó 
=
óó 
_orderRepository
óó *
.
óó* +
CreateOrder
óó+ 6
(
óó6 7
order
óó7 <
)
óó< =
;
óó= >
_orderRepository
öö 
.
öö  
CreateOrderPayment
öö /
(
öö/ 0
orderId
öö0 7
,
öö7 8
order
öö9 >
.
öö> ?
Total
öö? D
,
ööD E

creditCard
ööF P
.
ööP Q
Number
ööQ W
,
ööW X

creditCard
ööY c
.
ööc d
Expiry
ööd j
,
ööj k
approvalCode
ööl x
)
ööx y
;
ööy z
HttpContext
úú 
.
úú 
Session
úú 
.
úú  
SetInt32
úú  (
(
úú( )
$str
úú) 2
,
úú2 3
orderId
úú4 ;
)
úú; <
;
úú< =
HttpContext
ùù 
.
ùù 
Session
ùù 
.
ùù  
Remove
ùù  &
(
ùù& '
$str
ùù' -
)
ùù- .
;
ùù. /
return
ûû 
RedirectToAction
ûû #
(
ûû# $
$str
ûû$ -
)
ûû- .
;
ûû. /
}
üü 	
public
°° 
IActionResult
°° 
Receipt
°° $
(
°°$ %
int
°°% (
?
°°( )
id
°°* ,
)
°°, -
{
¢¢ 	
var
££ 
orderId
££ 
=
££ 
HttpContext
££ %
.
££% &
Session
££& -
.
££- .
GetInt32
££. 6
(
££6 7
$str
££7 @
)
££@ A
;
££A B
if
§§ 
(
§§ 
id
§§ 
!=
§§ 
null
§§ 
)
§§ 
{
•• 
orderId
¶¶ 
=
¶¶ 
id
¶¶ 
;
¶¶ 
}
ßß 
if
©© 
(
©© 
orderId
©© 
==
©© 
null
©© 
)
©©  
{
™™ 

ModelState
´´ 
.
´´ 
AddModelError
´´ (
(
´´( )
string
´´) /
.
´´/ 0
Empty
´´0 5
,
´´5 6
$str
´´7 ^
)
´´^ _
;
´´_ `
return
¨¨ 
View
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 
Order
ØØ 
order
ØØ 
;
ØØ 
try
∞∞ 
{
±± 
order
≤≤ 
=
≤≤ 
_orderRepository
≤≤ (
.
≤≤( )
GetOrderById
≤≤) 5
(
≤≤5 6
orderId
≤≤6 =
.
≤≤= >
Value
≤≤> C
)
≤≤C D
;
≤≤D E
}
≥≥ 
catch
¥¥ 
(
¥¥ '
InvalidOperationException
¥¥ ,
)
¥¥, -
{
µµ 

ModelState
∂∂ 
.
∂∂ 
AddModelError
∂∂ (
(
∂∂( )
string
∂∂) /
.
∂∂/ 0
Empty
∂∂0 5
,
∂∂5 6
string
∂∂7 =
.
∂∂= >
Format
∂∂> D
(
∂∂D E
$str
∂∂E _
,
∂∂_ `
orderId
∂∂a h
)
∂∂h i
)
∂∂i j
;
∂∂j k
return
∑∑ 
View
∑∑ 
(
∑∑ 
)
∑∑ 
;
∑∑ 
}
∏∏ 
return
∫∫ 
View
∫∫ 
(
∫∫ 
order
∫∫ 
)
∫∫ 
;
∫∫ 
}
ªª 	
public
ΩΩ 
IActionResult
ΩΩ 
Receipts
ΩΩ %
(
ΩΩ% &
)
ΩΩ& '
{
ææ 	
var
øø 
customer
øø 
=
øø #
GetCustomerOrAddError
øø 0
(
øø0 1
)
øø1 2
;
øø2 3
if
¿¿ 
(
¿¿ 
customer
¿¿ 
==
¿¿ 
null
¿¿ 
)
¿¿  
{
¡¡ 
return
¬¬ 
View
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
}
√√ 
return
≈≈ 
View
≈≈ 
(
≈≈ 
_orderRepository
≈≈ (
.
≈≈( )&
GetAllOrdersByCustomerId
≈≈) A
(
≈≈A B
customer
≈≈B J
.
≈≈J K

CustomerId
≈≈K U
)
≈≈U V
)
≈≈V W
;
≈≈W X
}
∆∆ 	
public
»» 
IActionResult
»» 
PackageTracking
»» ,
(
»», -
string
»»- 3
?
»»3 4
carrier
»»5 <
,
»»< =
string
»»> D
?
»»D E
trackingNumber
»»F T
)
»»T U
{
…… 	
var
   
model
   
=
   
new
   &
PackageTrackingViewModel
   4
(
  4 5
)
  5 6
{
ÀÀ 
SelectedCarrier
ÃÃ 
=
ÃÃ  !
carrier
ÃÃ" )
,
ÃÃ) *$
SelectedTrackingNumber
ÕÕ &
=
ÕÕ' (
trackingNumber
ÕÕ) 7
,
ÕÕ7 8
}
ŒŒ 
;
ŒŒ 
var
–– 
customer
–– 
=
–– #
GetCustomerOrAddError
–– 0
(
––0 1
)
––1 2
;
––2 3
if
—— 
(
—— 
customer
—— 
!=
—— 
null
——  
)
——  !
{
““ 
model
”” 
.
”” 
Orders
”” 
=
”” 
_orderRepository
”” /
.
””/ 0&
GetAllOrdersByCustomerId
””0 H
(
””H I
customer
””I Q
.
””Q R

CustomerId
””R \
)
””\ ]
;
””] ^
}
‘‘ 
return
÷÷ 
View
÷÷ 
(
÷÷ 
model
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 	
public
ŸŸ 
IActionResult
ŸŸ !
GoToExternalTracker
ŸŸ 0
(
ŸŸ0 1
string
ŸŸ1 7
carrier
ŸŸ8 ?
,
ŸŸ? @
string
ŸŸA G
trackingNumber
ŸŸH V
)
ŸŸV W
{
⁄⁄ 	
return
€€ 
Redirect
€€ 
(
€€ 
Order
€€ !
.
€€! "#
GetPackageTrackingUrl
€€" 7
(
€€7 8
carrier
€€8 ?
,
€€? @
trackingNumber
€€A O
)
€€O P
)
€€P Q
;
€€Q R
}
‹‹ 	
private
ﬁﬁ 
Customer
ﬁﬁ 
?
ﬁﬁ #
GetCustomerOrAddError
ﬁﬁ /
(
ﬁﬁ/ 0
)
ﬁﬁ0 1
{
ﬂﬂ 	
var
‡‡ 
username
‡‡ 
=
‡‡ 
_userManager
‡‡ '
.
‡‡' (
GetUserName
‡‡( 3
(
‡‡3 4
User
‡‡4 8
)
‡‡8 9
;
‡‡9 :
var
·· 
customer
·· 
=
·· !
_customerRepository
·· .
.
··. /#
GetCustomerByUsername
··/ D
(
··D E
username
··E M
)
··M N
;
··N O
if
‚‚ 
(
‚‚ 
customer
‚‚ 
==
‚‚ 
null
‚‚  
)
‚‚  !
{
„„ 

ModelState
‰‰ 
.
‰‰ 
AddModelError
‰‰ (
(
‰‰( )
string
‰‰) /
.
‰‰/ 0
Empty
‰‰0 5
,
‰‰5 6
$str
‰‰7 k
)
‰‰k l
;
‰‰l m
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÊÊ 
return
ËË 
customer
ËË 
;
ËË 
}
ÈÈ 	
private
ÎÎ 

CreditCard
ÎÎ "
GetCreditCardForUser
ÎÎ /
(
ÎÎ/ 0
)
ÎÎ0 1
{
ÏÏ 	
return
ÌÌ 
new
ÌÌ 

CreditCard
ÌÌ !
(
ÌÌ! "
)
ÌÌ" #
{
ÓÓ 
Filename
ÔÔ 
=
ÔÔ 
Path
ÔÔ 
.
ÔÔ  
Combine
ÔÔ  '
(
ÔÔ' (
_resourcePath
ÔÔ( 5
,
ÔÔ5 6
$str
ÔÔ7 N
)
ÔÔN O
,
ÔÔO P
Username
 
=
 
_userManager
 '
.
' (
GetUserName
( 3
(
3 4
User
4 8
)
8 9
}
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
}
ÛÛ 
}ÙÙ †
UC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\HomeController.cs
	namespace 	
WebGoatCore
 
. 
Controllers !
{		 
[

 
AllowAnonymous

 
]

 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
ProductRepository *
_productRepository+ =
;= >
public 
HomeController 
( 
ProductRepository /
productRepository0 A
)A B
{ 	
_productRepository 
=  
productRepository! 2
;2 3
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
new 
HomeViewModel )
() *
)* +
{ 
TopProducts 
= 
_productRepository 0
.0 1
GetTopProducts1 ?
(? @
$num@ A
)A B
} 
) 
; 
} 	
public 
IActionResult 
About "
(" #
)# $
=>% '
View( ,
(, -
)- .
;. /
[ 	
	Authorize	 
( 
Roles 
= 
$str "
)" #
]# $
public 
IActionResult 
Admin "
(" #
)# $
=>% '
View( ,
(, -
)- .
;. /
[!! 	
ResponseCache!!	 
(!! 
Duration!! 
=!!  !
$num!!" #
,!!# $
Location!!% -
=!!. /!
ResponseCacheLocation!!0 E
.!!E F
None!!F J
,!!J K
NoStore!!L S
=!!T U
true!!V Z
)!!Z [
]!![ \
public"" 
IActionResult"" 
Error"" "
(""" #
)""# $
{## 	
return$$ 
View$$ 
($$ 
new$$ 
ErrorViewModel$$ *
{%% 
	RequestId&& 
=&& 
Activity&& $
.&&$ %
Current&&% ,
?&&, -
.&&- .
Id&&. 0
??&&1 3
HttpContext&&4 ?
.&&? @
TraceIdentifier&&@ O
,&&O P
ExceptionInfo'' 
='' 
HttpContext''  +
.''+ ,
Features'', 4
.''4 5
Get''5 8
<''8 9(
IExceptionHandlerPathFeature''9 U
>''U V
(''V W
)''W X
,''X Y
}(( 
)(( 
;(( 
})) 	
}** 
}++ à\
XC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\ProductController.cs
	namespace

 	
WebGoatCore


 
.

 
Controllers

 !
{ 
[ 
Route 

(
 
$str "
)" #
]# $
public 

class 
ProductController "
:# $

Controller% /
{ 
private 
readonly 
ProductRepository *
_productRepository+ =
;= >
private 
readonly 
CategoryRepository +
_categoryRepository, ?
;? @
private 
readonly 
SupplierRepository +
_supplierRepository, ?
;? @
private 
readonly 
IWebHostEnvironment ,
_webHostEnvironment- @
;@ A
public 
ProductController  
(  !
ProductRepository! 2
productRepository3 D
,D E
IWebHostEnvironmentF Y
webHostEnvironmentZ l
,l m
CategoryRepository	n Ä 
categoryRepository
Å ì
,
ì î 
SupplierRepository
ï ß 
supplierRepository
® ∫
)
∫ ª
{ 	
_productRepository 
=  
productRepository! 2
;2 3
_categoryRepository 
=  !
categoryRepository" 4
;4 5
_supplierRepository 
=  !
supplierRepository" 4
;4 5
_webHostEnvironment 
=  !
webHostEnvironment" 4
;4 5
} 	
public 
IActionResult 
Search #
(# $
string$ *
?* +

nameFilter, 6
,6 7
int8 ;
?; <
selectedCategoryId= O
)O P
{ 	
if 
( 
selectedCategoryId "
!=# %
null& *
&&+ -
_categoryRepository. A
.A B
GetByIdB I
(I J
selectedCategoryIdJ \
.\ ]
Value] b
)b c
==d f
nullg k
)k l
{ 
selectedCategoryId   "
=  # $
null  % )
;  ) *
}!! 
var## 
product## 
=## 
_productRepository## ,
.##, -'
FindNonDiscontinuedProducts##- H
(##H I

nameFilter##I S
,##S T
selectedCategoryId##U g
)##g h
.$$ 
Select$$ 
($$ 
p$$ 
=>$$ 
new$$   
ProductListViewModel$$! 5
.$$5 6
ProductItem$$6 A
($$A B
)$$B C
{%% 
Product&& 
=&& 
p&& 
,&&  
ImageUrl'' 
='' !
GetImageUrlForProduct'' 4
(''4 5
p''5 6
)''6 7
,''7 8
}(( 
)(( 
;(( 
return** 
View** 
(** 
new**  
ProductListViewModel** 0
(**0 1
)**1 2
{++ 
Products,, 
=,, 
product,, "
,,," #
ProductCategories-- !
=--" #
_categoryRepository--$ 7
.--7 8
GetAllCategories--8 H
(--H I
)--I J
,--J K
SelectedCategoryId.. "
=..# $
selectedCategoryId..% 7
,..7 8

NameFilter// 
=// 

nameFilter// '
}00 
)00 
;00 
}11 	
[33 	
HttpGet33	 
(33 
$str33 
)33 
]33  
public44 
IActionResult44 
Details44 $
(44$ %
int44% (
	productId44) 2
,442 3
short444 9
quantity44: B
=44C D
$num44E F
)44F G
{55 	
var66 
model66 
=66 
new66 #
ProductDetailsViewModel66 3
(663 4
)664 5
;665 6
try77 
{88 
var99 
product99 
=99 
_productRepository99 0
.990 1
GetProductById991 ?
(99? @
	productId99@ I
)99I J
;99J K
model:: 
.:: 
Product:: 
=:: 
product::  '
;::' (
model;; 
.;; 
CanAddToCart;; "
=;;# $
true;;% )
;;;) *
model<< 
.<< 
ProductImageUrl<< %
=<<& '!
GetImageUrlForProduct<<( =
(<<= >
product<<> E
)<<E F
;<<F G
model== 
.== 
Quantity== 
===  
quantity==! )
;==) *
}>> 
catch?? 
(?? %
InvalidOperationException?? ,
)??, -
{@@ 
modelAA 
.AA 
ErrorMessageAA "
=AA# $
$strAA% 9
;AA9 :
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
modelEE 
.EE 
ErrorMessageEE "
=EE# $
stringEE% +
.EE+ ,
FormatEE, 2
(EE2 3
$strEE3 O
,EEO P
exEEQ S
.EES T
MessageEET [
)EE[ \
;EE\ ]
}FF 
returnHH 
ViewHH 
(HH 
modelHH 
)HH 
;HH 
}II 	
[KK 	
	AuthorizeKK	 
(KK 
RolesKK 
=KK 
$strKK "
)KK" #
]KK# $
publicLL 
IActionResultLL 
ManageLL #
(LL# $
)LL$ %
{MM 	
returnNN 
ViewNN 
(NN 
_productRepositoryNN *
.NN* +
GetAllProductsNN+ 9
(NN9 :
)NN: ;
)NN; <
;NN< =
}OO 	
[QQ 	
	AuthorizeQQ	 
(QQ 
RolesQQ 
=QQ 
$strQQ "
)QQ" #
]QQ# $
[RR 	
HttpGetRR	 
]RR 
publicSS 
IActionResultSS 
AddSS  
(SS  !
)SS! "
{TT 	
returnUU 
ViewUU 
(UU 
$strUU #
,UU# $
newUU% (%
ProductAddOrEditViewModelUU) B
(UUB C
)UUC D
{VV 
AddsNewWW 
=WW 
trueWW 
,WW 
ProductCategoriesXX !
=XX" #
_categoryRepositoryXX$ 7
.XX7 8
GetAllCategoriesXX8 H
(XXH I
)XXI J
,XXJ K
	SuppliersYY 
=YY 
_supplierRepositoryYY /
.YY/ 0
GetAllSuppliersYY0 ?
(YY? @
)YY@ A
,YYA B
}ZZ 
)ZZ 
;ZZ 
}[[ 	
[]] 	
	Authorize]]	 
(]] 
Roles]] 
=]] 
$str]] "
)]]" #
]]]# $
[^^ 	
HttpPost^^	 
]^^ 
public__ 
IActionResult__ 
Add__  
(__  !
Product__! (
product__) 0
)__0 1
{`` 	
tryaa 
{bb 
_productRepositorycc "
.cc" #
Addcc# &
(cc& '
productcc' .
)cc. /
;cc/ 0
returndd 
RedirectToActiondd '
(dd' (
$strdd( .
,dd. /
newdd0 3
{dd4 5
iddd6 8
=dd9 :
productdd; B
.ddB C
	ProductIdddC L
}ddM N
)ddN O
;ddO P
}ee 
catchff 
{gg 
returnhh 
Viewhh 
(hh 
$strhh '
,hh' (
newhh) ,%
ProductAddOrEditViewModelhh- F
(hhF G
)hhG H
{ii 
AddsNewjj 
=jj 
truejj "
,jj" #
ProductCategorieskk %
=kk& '
_categoryRepositorykk( ;
.kk; <
GetAllCategorieskk< L
(kkL M
)kkM N
,kkN O
	Suppliersll 
=ll 
_supplierRepositoryll  3
.ll3 4
GetAllSuppliersll4 C
(llC D
)llD E
,llE F
Productmm 
=mm 
productmm %
,mm% &
}nn 
)nn 
;nn 
}oo 
}pp 	
[rr 	
	Authorizerr	 
(rr 
Rolesrr 
=rr 
$strrr "
)rr" #
]rr# $
[ss 	
HttpGetss	 
(ss 
$strss 
)ss 
]ss 
publictt 
IActionResulttt 
Edittt !
(tt! "
inttt" %
idtt& (
)tt( )
{uu 	
returnvv 
Viewvv 
(vv 
$strvv #
,vv# $
newvv% (%
ProductAddOrEditViewModelvv) B
(vvB C
)vvC D
{ww 
AddsNewxx 
=xx 
falsexx 
,xx  
ProductCategoriesyy !
=yy" #
_categoryRepositoryyy$ 7
.yy7 8
GetAllCategoriesyy8 H
(yyH I
)yyI J
,yyJ K
Productzz 
=zz 
_productRepositoryzz ,
.zz, -
GetProductByIdzz- ;
(zz; <
idzz< >
)zz> ?
,zz? @
}{{ 
){{ 
;{{ 
}|| 	
[~~ 	
	Authorize~~	 
(~~ 
Roles~~ 
=~~ 
$str~~ "
)~~" #
]~~# $
[ 	
HttpPost	 
( 
$str 
) 
] 
public
ÄÄ 
IActionResult
ÄÄ 
Edit
ÄÄ !
(
ÄÄ! "
Product
ÄÄ" )
product
ÄÄ* 1
)
ÄÄ1 2
{
ÅÅ 	
product
ÇÇ 
=
ÇÇ  
_productRepository
ÇÇ (
.
ÇÇ( )
Update
ÇÇ) /
(
ÇÇ/ 0
product
ÇÇ0 7
)
ÇÇ7 8
;
ÇÇ8 9
return
ÉÉ 
View
ÉÉ 
(
ÉÉ 
$str
ÉÉ #
,
ÉÉ# $
new
ÉÉ% ('
ProductAddOrEditViewModel
ÉÉ) B
(
ÉÉB C
)
ÉÉC D
{
ÑÑ 
AddsNew
ÖÖ 
=
ÖÖ 
false
ÖÖ 
,
ÖÖ  
ProductCategories
ÜÜ !
=
ÜÜ" #!
_categoryRepository
ÜÜ$ 7
.
ÜÜ7 8
GetAllCategories
ÜÜ8 H
(
ÜÜH I
)
ÜÜI J
,
ÜÜJ K
Product
áá 
=
áá 
product
áá !
,
áá! "
}
àà 
)
àà 
;
àà 
}
ââ 	
private
ãã 
string
ãã #
GetImageUrlForProduct
ãã ,
(
ãã, -
Product
ãã- 4
product
ãã5 <
)
ãã< =
{
åå 	
var
çç 
imageUrl
çç 
=
çç 
$"
çç 
$str
çç 3
{
çç3 4
product
çç4 ;
.
çç; <
	ProductId
çç< E
}
ççE F
$str
ççF J
"
ççJ K
;
ççK L
if
éé 
(
éé 
!
éé !
_webHostEnvironment
éé $
.
éé$ %!
WebRootFileProvider
éé% 8
.
éé8 9
GetFileInfo
éé9 D
(
ééD E
imageUrl
ééE M
)
ééM N
.
ééN O
Exists
ééO U
)
ééU V
{
èè 
imageUrl
êê 
=
êê 
$str
êê >
;
êê> ?
}
ëë 
return
íí 
imageUrl
íí 
;
íí 
}
ìì 	
}
îî 
}ïï ı
[C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Controllers\StatusCodeController.cs
	namespace 	
WebGoatCore
 
. 
Controllers !
{ 
[ 
AllowAnonymous 
] 
[ "
IgnoreAntiforgeryToken 
] 
public		 

class		  
StatusCodeController		 %
:		& '

Controller		( 2
{

 
public 
const 
string 
NAME  
=! "
$str# /
;/ 0
public  
StatusCodeController #
(# $
)$ %
{ 	
} 	
[ 	
HttpGet	 
, 
Route 
( 
NAME 
) 
] 
public 
IActionResult 
StatusCodeView +
(+ ,
[, -
	FromQuery- 6
]6 7
int8 ;
code< @
)@ A
{ 	
var 
view 
= 
View 
( 
StatusCodeViewModel /
./ 0
Create0 6
(6 7
new7 :
ApiResponse; F
(F G
codeG K
)K L
)L M
)M N
;N O
view 
. 

StatusCode 
= 
code "
;" #
return 
view 
; 
} 	
} 
} Ô
SC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\BlogEntryRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public		 

class		 
BlogEntryRepository		 $
{

 
private 
readonly 
NorthwindContext )
_context* 2
;2 3
public 
BlogEntryRepository "
(" #
NorthwindContext# 3
context4 ;
); <
{ 	
_context 
= 
context 
; 
} 	
public 
	BlogEntry 
CreateBlogEntry (
(( )
string) /
title0 5
,5 6
string7 =
contents> F
,F G
stringH N
usernameO W
)W X
{ 	
var 
entry 
= 
new 
	BlogEntry %
{ 
Title 
= 
title 
, 
Contents 
= 
contents #
,# $
Author 
= 
username !
,! "

PostedDate 
= 
DateTime %
.% &
Now& )
,) *
} 
; 
entry 
= 
_context 
. 
BlogEntries (
.( )
Add) ,
(, -
entry- 2
)2 3
.3 4
Entity4 :
;: ;
_context 
. 
SaveChanges  
(  !
)! "
;" #
return 
entry 
; 
} 	
public!! 
	BlogEntry!! 
GetBlogEntry!! %
(!!% &
int!!& )
blogEntryId!!* 5
)!!5 6
{"" 	
return## 
_context## 
.## 
BlogEntries## '
.##' (
Single##( .
(##. /
b##/ 0
=>##1 3
b##4 5
.##5 6
Id##6 8
==##9 ;
blogEntryId##< G
)##G H
;##H I
}$$ 	
public&& 
List&& 
<&& 
	BlogEntry&& 
>&& 
GetTopBlogEntries&& 0
(&&0 1
)&&1 2
{'' 	
return(( 
GetTopBlogEntries(( $
((($ %
$num((% &
,((& '
$num((( )
)(() *
;((* +
})) 	
public++ 
List++ 
<++ 
	BlogEntry++ 
>++ 
GetTopBlogEntries++ 0
(++0 1
int++1 4
numberOfEntries++5 D
,++D E
int++F I
startPosition++J W
)++W X
{,, 	
var-- 
blogEntries-- 
=-- 
_context-- &
.--& '
BlogEntries--' 2
... 
OrderByDescending.. "
(.." #
b..# $
=>..% '
b..( )
...) *

PostedDate..* 4
)..4 5
.// 
Skip// 
(// 
startPosition// #
)//# $
.00 
Take00 
(00 
numberOfEntries00 %
)00% &
;00& '
return11 
blogEntries11 
.11 
ToList11 %
(11% &
)11& '
;11' (
}22 	
}33 
}44 »
VC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\BlogResponseRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class "
BlogResponseRepository '
{ 
private 
readonly 
NorthwindContext )
_context* 2
;2 3
public		 "
BlogResponseRepository		 %
(		% &
NorthwindContext		& 6
context		7 >
)		> ?
{

 	
_context 
= 
context 
; 
} 	
public 
void 
CreateBlogResponse &
(& '
BlogResponse' 3
response4 <
)< =
{ 	
_context 
. 
BlogResponses "
." #
Add# &
(& '
response' /
)/ 0
;0 1
_context 
. 
SaveChanges  
(  !
)! "
;" #
} 	
} 
} ¬
RC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\CategoryRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
CategoryRepository #
{ 
private		 
readonly		 
NorthwindContext		 )
_context		* 2
;		2 3
public 
CategoryRepository !
(! "
NorthwindContext" 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
Category 
> 
GetAllCategories .
(. /
)/ 0
{ 	
return 
_context 
. 

Categories &
.& '
OrderBy' .
(. /
c/ 0
=>1 3
c4 5
.5 6

CategoryId6 @
)@ A
.A B
ToListB H
(H I
)I J
;J K
} 	
public 
Category 
? 
GetById  
(  !
int! $
id% '
)' (
{ 	
return 
_context 
. 

Categories &
.& '
Find' +
(+ ,
id, .
). /
;/ 0
} 	
} 
} ©
IC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\Constants.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

static 
class 
	Constants !
{ 
public 
const 
string 
WEBGOAT_ROOT (
=) *
$str+ 9
;9 :
} 
} ˇ,
RC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\CustomerRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
CustomerRepository #
{ 
private		 
readonly		 
NorthwindContext		 )
_context		* 2
;		2 3
public 
CustomerRepository !
(! "
NorthwindContext" 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
Customer 
? !
GetCustomerByUsername .
(. /
string/ 5
username6 >
)> ?
{ 	
return 
_context 
. 
	Customers %
.% &
FirstOrDefault& 4
(4 5
c5 6
=>7 9
c: ;
.; <
ContactName< G
==H J
usernameK S
)S T
;T U
} 	
public 
Customer #
GetCustomerByCustomerId /
(/ 0
string0 6

customerId7 A
)A B
{ 	
return 
_context 
. 
	Customers %
.% &
Single& ,
(, -
c- .
=>/ 1
c2 3
.3 4

CustomerId4 >
==? A

customerIdB L
)L M
;M N
} 	
public 
void 
SaveCustomer  
(  !
Customer! )
customer* 2
)2 3
{ 	
_context 
. 
Update 
( 
customer $
)$ %
;% &
_context 
. 
SaveChanges  
(  !
)! "
;" #
} 	
public!! 
string!! 
CreateCustomer!! $
(!!$ %
string!!% +
companyName!!, 7
,!!7 8
string!!9 ?
contactName!!@ K
,!!K L
string!!M S
?!!S T
address!!U \
,!!\ ]
string!!^ d
?!!d e
city!!f j
,!!j k
string!!l r
?!!r s
region!!t z
,!!z {
string	!!| Ç
?
!!Ç É

postalCode
!!Ñ é
,
!!é è
string
!!ê ñ
?
!!ñ ó
country
!!ò ü
)
!!ü †
{"" 	
var## 

customerId## 
=## 
GenerateCustomerId## /
(##/ 0
companyName##0 ;
)##; <
;##< =
var$$ 
customer$$ 
=$$ 
new$$ 
Customer$$ '
($$' (
)$$( )
{%% 
CompanyName&& 
=&& 
companyName&& )
,&&) *

CustomerId'' 
='' 

customerId'' '
,''' (
ContactName(( 
=(( 
contactName(( )
,(() *
Address)) 
=)) 
address)) !
,))! "
City** 
=** 
city** 
,** 
Region++ 
=++ 
region++ 
,++  

PostalCode,, 
=,, 

postalCode,, '
,,,' (
Country-- 
=-- 
country-- !
}.. 
;.. 
_context// 
.// 
	Customers// 
.// 
Add// "
(//" #
customer//# +
)//+ ,
;//, -
_context00 
.00 
SaveChanges00  
(00  !
)00! "
;00" #
return11 

customerId11 
;11 
}22 	
public44 
bool44 
CustomerIdExists44 $
(44$ %
string44% +

customerId44, 6
)446 7
{55 	
return66 
_context66 
.66 
	Customers66 %
.66% &
Any66& )
(66) *
c66* +
=>66, .
c66/ 0
.660 1

CustomerId661 ;
==66< >

customerId66? I
)66I J
;66J K
}77 	
private<< 
string<< 
GenerateCustomerId<< )
(<<) *
string<<* 0
companyName<<1 <
)<<< =
{== 	
var>> 
random>> 
=>> 
new>> 
Random>> #
(>># $
)>>$ %
;>>% &
var?? 

customerId?? 
=?? 
companyName?? (
.??( )
Replace??) 0
(??0 1
$str??1 4
,??4 5
$str??6 8
)??8 9
;??9 :

customerId@@ 
=@@ 
(@@ 

customerId@@ $
.@@$ %
Length@@% +
>=@@, .
$num@@/ 0
)@@0 1
?@@2 3

customerId@@4 >
.@@> ?
	Substring@@? H
(@@H I
$num@@I J
,@@J K
$num@@L M
)@@M N
:@@O P

customerId@@Q [
;@@[ \
whileAA 
(AA 
CustomerIdExistsAA #
(AA# $

customerIdAA$ .
)AA. /
)AA/ 0
{BB 

customerIdCC 
=CC 

customerIdCC '
.CC' (
	SubstringCC( 1
(CC1 2
$numCC2 3
,CC3 4
$numCC5 6
)CC6 7
+CC8 9
$strCC: `
[CC` a
randomCCa g
.CCg h
NextCCh l
(CCl m
$numCCm o
)CCo p
]CCp q
;CCq r
}DD 
returnEE 

customerIdEE 
;EE 
}FF 	
}GG 
}HH Ï1
PC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\NorthwindContext.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
NorthwindContext !
:" #
IdentityDbContext$ 5
<5 6
IdentityUser6 B
>B C
{ 
public 
static 
void 

Initialize %
(% &
IConfiguration& 4
configuration5 B
,B C
IHostEnvironmentD T
envU X
)X Y
{ 	
var 
execDirectory 
= 
configuration  -
.- .
GetValue. 6
(6 7
	Constants7 @
.@ A
WEBGOAT_ROOTA M
,M N
envO R
.R S
ContentRootPathS b
)b c
;c d
var 
builder 
= 
new )
SqliteConnectionStringBuilder ;
(; <
)< =
;= >
builder 
. 

DataSource 
=  
Path! %
.% &
Combine& -
(- .
execDirectory. ;
,; <
$str= N
)N O
;O P

ConnString 
= 
builder  
.  !
ConnectionString! 1
;1 2
if 
( 
string 
. 
IsNullOrEmpty #
(# $

ConnString$ .
). /
)/ 0
{ 
throw 
new 
WebGoatCore %
.% &

Exceptions& 0
.0 1#
WebGoatStartupException1 H
(H I
$str	I Ä
)
Ä Å
;
Å Ç
} 
} 	
public 
static 
string 
? 

ConnString (
;( )
public 
static 
readonly 
LoggerFactory ,
_myLoggerFactory- =
=> ?
new 
LoggerFactory 
( 
new !
[! "
]" #
{$ %
new 
	Microsoft 
. 

Extensions (
.( )
Logging) 0
.0 1
Debug1 6
.6 7
DebugLoggerProvider7 J
(J K
)K L
}   	
)  	 

;  
 
public## 
NorthwindContext## 
(##  
DbContextOptions##  0
<##0 1
NorthwindContext##1 A
>##A B
options##C J
)##J K
:%% 
base%% 
(%% 
options%% 
)%% 
{&& 	
}'' 	
public)) 
DbSet)) 
<)) 
	BlogEntry)) 
>)) 
BlogEntries))  +
{)), -
get)). 1
;))1 2
set))3 6
;))6 7
}))8 9
public** 
DbSet** 
<** 
BlogResponse** !
>**! "
BlogResponses**# 0
{**1 2
get**3 6
;**6 7
set**8 ;
;**; <
}**= >
public++ 
DbSet++ 
<++ 
Category++ 
>++ 

Categories++ )
{++* +
get++, /
;++/ 0
set++1 4
;++4 5
}++6 7
public,, 
DbSet,, 
<,, 
Customer,, 
>,, 
	Customers,, (
{,,) *
get,,+ .
;,,. /
set,,0 3
;,,3 4
},,5 6
public-- 
DbSet-- 
<-- 
Order-- 
>-- 
Orders-- "
{--# $
get--% (
;--( )
set--* -
;--- .
}--/ 0
public.. 
DbSet.. 
<.. 
OrderDetail..  
>..  !
OrderDetails.." .
{../ 0
get..1 4
;..4 5
set..6 9
;..9 :
}..; <
public// 
DbSet// 
<// 
OrderPayment// !
>//! "
OrderPayments//# 0
{//1 2
get//3 6
;//6 7
set//8 ;
;//; <
}//= >
public00 
DbSet00 
<00 
Product00 
>00 
Products00 &
{00' (
get00) ,
;00, -
set00. 1
;001 2
}003 4
public11 
DbSet11 
<11 
Shipper11 
>11 
Shippers11 &
{11' (
get11) ,
;11, -
set11. 1
;111 2
}113 4
public22 
DbSet22 
<22 
Shipment22 
>22 
	Shipments22 (
{22) *
get22+ .
;22. /
set220 3
;223 4
}225 6
public33 
DbSet33 
<33 
Supplier33 
>33 
	Suppliers33 (
{33) *
get33+ .
;33. /
set330 3
;333 4
}335 6
	protected55 
override55 
void55 
OnModelCreating55  /
(55/ 0
ModelBuilder550 <
modelBuilder55= I
)55I J
{66 	
base77 
.77 
OnModelCreating77  
(77  !
modelBuilder77! -
)77- .
;77. /
modelBuilder88 
.88 
Entity88 
<88  
OrderDetail88  +
>88+ ,
(88, -
)88- .
.88. /
HasKey88/ 5
(885 6
a886 7
=>888 :
new88; >
{88? @
a88A B
.88B C
	ProductId88C L
,88L M
a88N O
.88O P
OrderId88P W
}88X Y
)88Y Z
;88Z [
}99 	
	protected;; 
override;; 
void;; 
OnConfiguring;;  -
(;;- .#
DbContextOptionsBuilder;;. E
optionsBuilder;;F T
);;T U
{<< 	
optionsBuilder== 
.== 
UseLoggerFactory== +
(==+ ,
_myLoggerFactory==, <
)==< =
;=== >
optionsBuilder>> 
.>> &
EnableSensitiveDataLogging>> 5
(>>5 6
)>>6 7
;>>7 8
}?? 	
}@@ 
}AA »U
OC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\OrderRepository.cs
	namespace		 	
WebGoatCore		
 
.		 
Data		 
{

 
public 

class 
OrderRepository  
{ 
private 
readonly 
NorthwindContext )
_context* 2
;2 3
private 
readonly 
CustomerRepository +
_customerRepository, ?
;? @
public 
OrderRepository 
( 
NorthwindContext /
context0 7
,7 8
CustomerRepository9 K
customerRepositoryL ^
)^ _
{ 	
_context 
= 
context 
; 
_customerRepository 
=  !
customerRepository" 4
;4 5
} 	
public 
Order 
GetOrderById !
(! "
int" %
orderId& -
)- .
{ 	
return 
_context 
. 
Orders "
." #
Single# )
() *
o* +
=>, .
o/ 0
.0 1
OrderId1 8
==9 ;
orderId< C
)C D
;D E
} 	
public 
int 
CreateOrder 
( 
Order $
order% *
)* +
{ 	
Thread 
. 
CurrentThread  
.  !
CurrentCulture! /
=0 1
new2 5
CultureInfo6 A
(A B
$strB I
)I J
;J K
string%% 
shippedDate%% 
=%%  
order%%! &
.%%& '
ShippedDate%%' 2
.%%2 3
HasValue%%3 ;
?%%< =
$str%%> A
+%%B C
string%%D J
.%%J K
Format%%K Q
(%%Q R
$str%%R ^
,%%^ _
order%%` e
.%%e f
ShippedDate%%f q
.%%q r
Value%%r w
)%%w x
+%%y z
$str%%{ ~
:	%% Ä
$str
%%Å á
;
%%á à
var&& 
sql&& 
=&& 
$str&& ,
+&&- .
$str'' y
+''z {
$str(( C
+((D E
$str)) 
+)) 
$"** 
$str** 
{** 
order** 
.** 

CustomerId** $
}**$ %
$str**% (
{**( )
order**) .
.**. /

EmployeeId**/ 9
}**9 :
$str**: =
{**= >
order**> C
.**C D
	OrderDate**D M
:**M N
$str**N X
}**X Y
$str**Y \
{**\ ]
order**] b
.**b c
RequiredDate**c o
:**o p
$str**p z
}**z {
$str**{ }
"**} ~
+	** Ä
$"++ 
{++ 
shippedDate++ 
}++ 
$str++ !
{++! "
order++" '
.++' (
ShipVia++( /
}++/ 0
$str++0 3
{++3 4
order++4 9
.++9 :
Freight++: A
}++A B
$str++B E
{++E F
order++F K
.++K L
ShipName++L T
}++T U
$str++U X
{++X Y
order++Y ^
.++^ _
ShipAddress++_ j
}++j k
$str++k m
"++m n
+++o p
$",, 
$str,, 
{,, 
order,, 
.,, 
ShipCity,, "
},," #
$str,,# &
{,,& '
order,,' ,
.,,, -

ShipRegion,,- 7
},,7 8
$str,,8 ;
{,,; <
order,,< A
.,,A B
ShipPostalCode,,B P
},,P Q
$str,,Q T
{,,T U
order,,U Z
.,,Z [
ShipCountry,,[ f
},,f g
$str,,g i
",,i j
;,,j k
sql-- 
+=-- 
$str-- Q
;--Q R
using// 
(// 
var// 
command// 
=//  
_context//! )
.//) *
Database//* 2
.//2 3
GetDbConnection//3 B
(//B C
)//C D
.//D E
CreateCommand//E R
(//R S
)//S T
)//T U
{00 
command11 
.11 
CommandText11 #
=11$ %
sql11& )
;11) *
_context22 
.22 
Database22 !
.22! "
OpenConnection22" 0
(220 1
)221 2
;222 3
using44 
var44 

dataReader44 $
=44% &
command44' .
.44. /
ExecuteReader44/ <
(44< =
)44= >
;44> ?

dataReader55 
.55 
Read55 
(55  
)55  !
;55! "
order66 
.66 
OrderId66 
=66 
Convert66  '
.66' (
ToInt3266( /
(66/ 0

dataReader660 :
[66: ;
$num66; <
]66< =
)66= >
;66> ?
}77 
sql99 
=99 
$str99 1
+992 3
$str:: C
+::D E
$str;; 
;;; 
foreach<< 
(<< 
var<< 
(<< 
orderDetails<< &
,<<& '
i<<( )
)<<) *
in<<+ -
order<<. 3
.<<3 4
OrderDetails<<4 @
.<<@ A
	WithIndex<<A J
(<<J K
)<<K L
)<<L M
{== 
orderDetails>> 
.>> 
OrderId>> $
=>>% &
order>>' ,
.>>, -
OrderId>>- 4
;>>4 5
sql?? 
+=?? 
(?? 
i?? 
>?? 
$num?? 
??? 
$str??  #
:??$ %
$str??& (
)??( )
+??* +
$"@@ 
$str@@ 
{@@ 
orderDetails@@ %
.@@% &
OrderId@@& -
}@@- .
$str@@. 1
{@@1 2
orderDetails@@2 >
.@@> ?
	ProductId@@? H
}@@H I
$str@@I L
{@@L M
orderDetails@@M Y
.@@Y Z
	UnitPrice@@Z c
}@@c d
$str@@d g
{@@g h
orderDetails@@h t
.@@t u
Quantity@@u }
}@@} ~
$str	@@~ Ä
"
@@Ä Å
+
@@Ç É
$"AA 
$strAA 
{AA 
orderDetailsAA $
.AA$ %
DiscountAA% -
}AA- .
$strAA. 0
"AA0 1
;AA1 2
}BB 
ifDD 
(DD 
orderDD 
.DD 
ShipmentDD 
!=DD !
nullDD" &
)DD& '
{EE 
varFF 
shipmentFF 
=FF 
orderFF $
.FF$ %
ShipmentFF% -
;FF- .
shipmentGG 
.GG 
OrderIdGG  
=GG! "
orderGG# (
.GG( )
OrderIdGG) 0
;GG0 1
sqlHH 
+=HH 
$strHH 3
+HH4 5
$strII F
+IIG H
$strJJ  
+JJ! "
$"KK 
$strKK 
{KK 
shipmentKK  
.KK  !
OrderIdKK! (
}KK( )
$strKK) ,
{KK, -
shipmentKK- 5
.KK5 6
	ShipperIdKK6 ?
}KK? @
$strKK@ C
{KKC D
shipmentKKD L
.KKL M
ShipmentDateKKM Y
:KKY Z
$strKKZ d
}KKd e
$strKKe h
{KKh i
shipmentKKi q
.KKq r
TrackingNumber	KKr Ä
}
KKÄ Å
$str
KKÅ É
"
KKÉ Ñ
;
KKÑ Ö
}LL 
usingNN 
(NN 
varNN 
commandNN 
=NN  
_contextNN! )
.NN) *
DatabaseNN* 2
.NN2 3
GetDbConnectionNN3 B
(NNB C
)NNC D
.NND E
CreateCommandNNE R
(NNR S
)NNS T
)NNT U
{OO 
commandPP 
.PP 
CommandTextPP #
=PP$ %
sqlPP& )
;PP) *
_contextQQ 
.QQ 
DatabaseQQ !
.QQ! "
OpenConnectionQQ" 0
(QQ0 1
)QQ1 2
;QQ2 3
commandRR 
.RR 
ExecuteNonQueryRR '
(RR' (
)RR( )
;RR) *
}SS 
returnUU 
orderUU 
.UU 
OrderIdUU  
;UU  !
}VV 	
publicXX 
voidXX 
CreateOrderPaymentXX &
(XX& '
intXX' *
orderIdXX+ 2
,XX2 3
decimalXX4 ;

amountPaidXX< F
,XXF G
stringXXH N
creditCardNumberXXO _
,XX_ `
DateTimeXXa i
expirationDateXXj x
,XXx y
string	XXz Ä
approvalCode
XXÅ ç
)
XXç é
{YY 	
varZZ 
orderPaymentZZ 
=ZZ 
newZZ "
OrderPaymentZZ# /
(ZZ/ 0
)ZZ0 1
{[[ 

AmountPaid\\ 
=\\ 
Convert\\ $
.\\$ %
ToDouble\\% -
(\\- .

amountPaid\\. 8
)\\8 9
,\\9 :
CreditCardNumber]]  
=]]! "
creditCardNumber]]# 3
,]]3 4
ApprovalCode^^ 
=^^ 
approvalCode^^ +
,^^+ ,
ExpirationDate__ 
=__  
expirationDate__! /
,__/ 0
OrderId`` 
=`` 
orderId`` !
,``! "
PaymentDateaa 
=aa 
DateTimeaa &
.aa& '
Nowaa' *
}bb 
;bb 
_contextcc 
.cc 
OrderPaymentscc "
.cc" #
Addcc# &
(cc& '
orderPaymentcc' 3
)cc3 4
;cc4 5
_contextdd 
.dd 
SaveChangesdd  
(dd  !
)dd! "
;dd" #
}ee 	
publicgg 
ICollectiongg 
<gg 
Ordergg  
>gg  !$
GetAllOrdersByCustomerIdgg" :
(gg: ;
stringgg; A

customerIdggB L
)ggL M
{hh 	
returnii 
_contextii 
.ii 
Ordersii "
.jj 
Wherejj 
(jj 
ojj 
=>jj 
ojj 
.jj 

CustomerIdjj (
==jj) +

customerIdjj, 6
)jj6 7
.kk 
OrderByDescendingkk "
(kk" #
okk# $
=>kk% '
okk( )
.kk) *
	OrderDatekk* 3
)kk3 4
.ll 
ThenByDescendingll !
(ll! "
oll" #
=>ll$ &
oll' (
.ll( )
OrderIdll) 0
)ll0 1
.mm 
ToListmm 
(mm 
)mm 
;mm 
}nn 	
}oo 
}pp â;
QC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\ProductRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
ProductRepository "
{		 
private

 
readonly

 
NorthwindContext

 )
_context

* 2
;

2 3
public 
ProductRepository  
(  !
NorthwindContext! 1
context2 9
)9 :
{ 	
_context 
= 
context 
; 
} 	
public 
Product 
GetProductById %
(% &
int& )
	productId* 3
)3 4
{ 	
return 
_context 
. 
Products $
.$ %
Single% +
(+ ,
p, -
=>. 0
p1 2
.2 3
	ProductId3 <
=== ?
	productId@ I
)I J
;J K
} 	
public 
List 
< 
Product 
> 
GetTopProducts +
(+ ,
int, /$
numberOfProductsToReturn0 H
)H I
{ 	
var 
	orderDate 
= 
DateTime $
.$ %
Today% *
.* +
	AddMonths+ 4
(4 5
-5 6
$num6 7
)7 8
;8 9
var 
topProducts 
= 
_context &
.& '
Orders' -
. 
Where 
( 
o 
=> 
o 
. 
	OrderDate '
>( )
	orderDate* 3
)3 4
. 
Join 
( 
_context 
. 
OrderDetails +
,+ ,
o- .
=>/ 1
o2 3
.3 4
OrderId4 ;
,; <
od= ?
=>@ B
odC E
.E F
OrderIdF M
,M N
(O P
oP Q
,Q R
odS U
)U V
=>W Y
odZ \
)\ ]
. 
AsEnumerable 
( 
) 
. 
GroupBy 
( 
od 
=> 
od !
.! "
Product" )
)) *
. 
OrderByDescending "
(" #
g# $
=>% '
g( )
.) *
Sum* -
(- .
t. /
=>0 2
t3 4
.4 5
	UnitPrice5 >
*? @
tA B
.B C
QuantityC K
)K L
)L M
.   
Select   
(   
g   
=>   
g   
.   
Key   "
)  " #
.!! 
Take!! 
(!! $
numberOfProductsToReturn!! .
)!!. /
."" 
ToList"" 
("" 
)"" 
;"" 
if$$ 
($$ 
topProducts$$ 
.$$ 
Count$$  
<$$! "
$num$$# $
)$$$ %
{%% 
topProducts&& 
.&& 
AddRange&& $
(&&$ %
_context&&% -
.&&- .
Products&&. 6
.'' 
OrderByDescending'' &
(''& '
p''' (
=>'') +
p'', -
.''- .
	UnitPrice''. 7
)''7 8
.(( 
Take(( 
((( $
numberOfProductsToReturn(( 2
-((3 4
topProducts((5 @
.((@ A
Count((A F
)((F G
.)) 
ToList)) 
()) 
))) 
))) 
;)) 
}** 
return,, 
topProducts,, 
;,, 
}-- 	
public// 
List// 
<// 
Product// 
>// 
GetAllProducts// +
(//+ ,
)//, -
{00 	
return11 
_context11 
.11 
Products11 $
.11$ %
OrderBy11% ,
(11, -
p11- .
=>11/ 1
p112 3
.113 4
ProductName114 ?
)11? @
.11@ A
ToList11A G
(11G H
)11H I
;11I J
}22 	
public44 
List44 
<44 
Product44 
>44 '
FindNonDiscontinuedProducts44 8
(448 9
string449 ?
?44? @
productName44A L
,44L M
int44N Q
?44Q R

categoryId44S ]
)44] ^
{55 	
var66 
products66 
=66 
_context66 #
.66# $
Products66$ ,
.66, -
Where66- 2
(662 3
p663 4
=>665 7
!668 9
p669 :
.66: ;
Discontinued66; G
)66G H
;66H I
if88 
(88 

categoryId88 
!=88 
null88 "
)88" #
{99 
products:: 
=:: 
products:: #
.::# $
Where::$ )
(::) *
p::* +
=>::, .
p::/ 0
.::0 1

CategoryId::1 ;
==::< >

categoryId::? I
)::I J
;::J K
};; 
if<< 
(<< 
productName<< 
!=<< 
null<< #
)<<# $
{== 
return>> 
products>>  
.>>  !
ToList>>! '
(>>' (
)>>( )
.>>) *
Where>>* /
(>>/ 0
p>>0 1
=>>>2 4
p>>5 6
.>>6 7
ProductName>>7 B
.>>B C
Contains>>C K
(>>K L
productName>>L W
,>>W X
StringComparison>>Y i
.>>i j%
CurrentCultureIgnoreCase	>>j Ç
)
>>Ç É
)
>>É Ñ
.
>>Ñ Ö
OrderBy
>>Ö å
(
>>å ç
p
>>ç é
=>
>>è ë
p
>>í ì
.
>>ì î
ProductName
>>î ü
)
>>ü †
.
>>† °
ToList
>>° ß
(
>>ß ®
)
>>® ©
;
>>© ™
}?? 
returnAA 
productsAA 
.AA 
OrderByAA #
(AA# $
pAA$ %
=>AA& (
pAA) *
.AA* +
ProductNameAA+ 6
)AA6 7
.AA7 8
ToListAA8 >
(AA> ?
)AA? @
;AA@ A
}BB 	
publicDD 
ProductDD 
UpdateDD 
(DD 
ProductDD %
productDD& -
)DD- .
{EE 	
productFF 
=FF 
_contextFF 
.FF 
ProductsFF '
.FF' (
UpdateFF( .
(FF. /
productFF/ 6
)FF6 7
.FF7 8
EntityFF8 >
;FF> ?
_contextGG 
.GG 
SaveChangesGG  
(GG  !
)GG! "
;GG" #
returnHH 
productHH 
;HH 
}II 	
publicKK 
voidKK 
AddKK 
(KK 
ProductKK 
productKK  '
)KK' (
{LL 	
_contextMM 
.MM 
ProductsMM 
.MM 
AddMM !
(MM! "
productMM" )
)MM) *
;MM* +
_contextNN 
.NN 
SaveChangesNN  
(NN  !
)NN! "
;NN" #
}OO 	
}PP 
}QQ ¨5
QC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\ShipperRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
ShipperRepository "
{		 
private

 
readonly

 
NorthwindContext

 )
_context

* 2
;

2 3
public 
ShipperRepository  
(  !
NorthwindContext! 1
context2 9
)9 :
{ 	
_context 
= 
context 
; 
} 	
public 

Dictionary 
< 
int 
, 
string %
>% &
GetShippingOptions' 9
(9 :
decimal: A
orderSubtotalB O
)O P
{ 	
return 
_context 
. 
Shippers $
.$ %
ToDictionary% 1
(1 2
s 
=> 
s 
. 
	ShipperId  
,  !
s 
=> !
GetShippingCostString *
(* +
s+ ,
,, -
orderSubtotal. ;
); <
)< =
;= >
} 	
private 
string !
GetShippingCostString ,
(, -
Shipper- 4
shipper5 <
,< =
decimal> E
orderSubtotalF S
)S T
{ 	
var 
shippingCost 
= 
Math #
.# $
Round$ )
() *
shipper* 1
.1 2
GetShippingCost2 A
(A B
orderSubtotalB O
)O P
,P Q
$numR S
)S T
.T U
ToStringU ]
(] ^
System^ d
.d e
Globalizatione r
.r s
CultureInfos ~
.~ 
GetCultureInfo	 ç
(
ç é
$str
é ï
)
ï ñ
)
ñ ó
;
ó ò
return 
$" 
{ 
shipper 
. 
CompanyName )
}) *
$str* +
{+ ,
shipper, 3
.3 4
ServiceName4 ?
}? @
$str@ C
{C D
shippingCostD P
}P Q
"Q R
;R S
} 	
public 
Shipper !
GetShipperByShipperId ,
(, -
int- 0
	shipperId1 :
): ;
{ 	
return   
_context   
.   
Shippers   $
.  $ %
Single  % +
(  + ,
s  , -
=>  . 0
s  1 2
.  2 3
	ShipperId  3 <
==  = ?
	shipperId  @ I
)  I J
;  J K
}!! 	
public,, 
string,, !
GetNextTrackingNumber,, +
(,,+ ,
Shipper,,, 3
shipper,,4 ;
),,; <
{-- 	
var.. 
random.. 
=.. 
new.. 
Random.. #
(..# $
)..$ %
;..% &
var// 
companyName// 
=// 
shipper// %
.//% &
CompanyName//& 1
;//1 2
if00 
(00 
companyName00 
.00 
Contains00 $
(00$ %
$str00% *
)00* +
)00+ ,
{11 
return22 
string22 
.22 
Format22 $
(22$ %
$str22% @
,22@ A
random22B H
.22H I
Next22I M
(22M N
$num22N Q
)22Q R
.22R S
ToString22S [
(22[ \
$str22\ a
)22a b
,22b c
random22d j
.22j k
Next22k o
(22o p
$num22p s
)22s t
.22t u
ToString22u }
(22} ~
$str	22~ É
)
22É Ñ
,
22Ñ Ö
random
22Ü å
.
22å ç
Next
22ç ë
(
22ë í
$num
22í î
)
22î ï
.
22ï ñ
ToString
22ñ û
(
22û ü
$str
22ü £
)
22£ §
,
22§ •
random
22¶ ¨
.
22¨ ≠
Next
22≠ ±
(
22± ≤
$num
22≤ ∂
)
22∂ ∑
.
22∑ ∏
ToString
22∏ ¿
(
22¿ ¡
$str
22¡ «
)
22« »
,
22» …
random
22  –
.
22– —
Next
22— ’
(
22’ ÷
$num
22÷ Ÿ
)
22Ÿ ⁄
.
22⁄ €
ToString
22€ „
(
22„ ‰
$str
22‰ È
)
22È Í
,
22Í Î
random
22Ï Ú
.
22Ú Û
Next
22Û ˜
(
22˜ ¯
$num
22¯ ˘
)
22˘ ˙
.
22˙ ˚
ToString
22˚ É
(
22É Ñ
$str
22Ñ á
)
22á à
)
22à â
;
22â ä
}33 
else44 
if44 
(44 
companyName44  
.44  !
Contains44! )
(44) *
$str44* 1
)441 2
)442 3
{55 
return66 
string66 
.66 
Format66 $
(66$ %
$str66% -
,66- .
random66/ 5
.665 6
Next666 :
(66: ;
$num66; A
)66A B
.66B C
ToString66C K
(66K L
$str66L T
)66T U
,66U V
random66W ]
.66] ^
Next66^ b
(66b c
$num66c i
)66i j
.66j k
ToString66k s
(66s t
$str66t |
)66| }
)66} ~
;66~ 
}77 
else88 
if88 
(88 
companyName88  
.88  !
Contains88! )
(88) *
$str88* =
)88= >
)88> ?
{99 
return:: 
string:: 
.:: 
Format:: $
(::$ %
$str::% 2
,::2 3
random::4 :
.::: ;
Next::; ?
(::? @
$num::@ D
)::D E
.::E F
ToString::F N
(::N O
$str::O U
)::U V
,::V W
random::X ^
.::^ _
Next::_ c
(::c d
$num::d h
)::h i
.::i j
ToString::j r
(::r s
$str::s y
)::y z
,::z {
random	::| Ç
.
::Ç É
Next
::É á
(
::á à
$num
::à ä
)
::ä ã
.
::ã å
ToString
::å î
(
::î ï
$str
::ï ô
)
::ô ö
)
::ö õ
;
::õ ú
};; 
else<< 
{== 
return>> 
$str>> 8
;>>8 9
}?? 
}@@ 	
}AA 
}BB Á
RC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Data\SupplierRepository.cs
	namespace 	
WebGoatCore
 
. 
Data 
{ 
public 

class 
SupplierRepository #
{ 
private		 
readonly		 
NorthwindContext		 )
_context		* 2
;		2 3
public 
SupplierRepository !
(! "
NorthwindContext" 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
Supplier 
> 
GetAllSuppliers -
(- .
). /
{ 	
return 
_context 
. 
	Suppliers %
.% &
OrderBy& -
(- .
s. /
=>0 2
s3 4
.4 5
CompanyName5 @
)@ A
.A B
ToListB H
(H I
)I J
;J K
} 	
} 
} ·
^C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Exceptions\AbstractWebGoatException.cs
	namespace 	
WebGoatCore
 
. 

Exceptions  
{ 
public 

abstract 
class $
AbstractWebGoatException 2
:3 4 
ApplicationException5 I
{ 
	protected $
AbstractWebGoatException *
(* +
)+ ,
{		 	
}

 	
	protected $
AbstractWebGoatException *
(* +
string+ 1
?1 2
message3 :
): ;
:< =
base> B
(B C
messageC J
)J K
{ 	
} 	
	protected $
AbstractWebGoatException *
(* +
SerializationInfo+ <
info= A
,A B
StreamingContextC S
contextT [
)[ \
:] ^
base_ c
(c d
infod h
,h i
contextj q
)q r
{ 	
} 	
	protected $
AbstractWebGoatException *
(* +
string+ 1
?1 2
message3 :
,: ;
	Exception< E
?E F
innerExceptionG U
)U V
:W X
baseY ]
(] ^
message^ e
,e f
innerExceptiong u
)u v
{ 	
} 	
} 
} ˇ
hC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Exceptions\WebGoatCreditCardNotFoundException.cs
	namespace 	
WebGoatCore
 
. 

Exceptions  
{ 
public 

class .
"WebGoatCreditCardNotFoundException 3
:4 5$
AbstractWebGoatException6 N
{ 
public .
"WebGoatCreditCardNotFoundException 1
(1 2
)2 3
{		 	
}

 	
public .
"WebGoatCreditCardNotFoundException 1
(1 2
string2 8
?8 9
message: A
)A B
:C D
baseE I
(I J
messageJ Q
)Q R
{ 	
} 	
public .
"WebGoatCreditCardNotFoundException 1
(1 2
SerializationInfo2 C
infoD H
,H I
StreamingContextJ Z
context[ b
)b c
:d e
basef j
(j k
infok o
,o p
contextq x
)x y
{ 	
} 	
public .
"WebGoatCreditCardNotFoundException 1
(1 2
string2 8
?8 9
message: A
,A B
	ExceptionC L
?L M
innerExceptionN \
)\ ]
:^ _
base` d
(d e
messagee l
,l m
innerExceptionn |
)| }
{ 	
} 	
} 
} ±
[C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Exceptions\WebGoatFatalException.cs
	namespace 	
WebGoatCore
 
. 

Exceptions  
{ 
public 

class !
WebGoatFatalException &
:' ($
AbstractWebGoatException) A
{ 
public !
WebGoatFatalException $
($ %
)% &
{		 	
}

 	
public !
WebGoatFatalException $
($ %
string% +
?+ ,
message- 4
)4 5
:6 7
base8 <
(< =
message= D
)D E
{ 	
} 	
public !
WebGoatFatalException $
($ %
SerializationInfo% 6
info7 ;
,; <
StreamingContext= M
contextN U
)U V
:W X
baseY ]
(] ^
info^ b
,b c
contextd k
)k l
{ 	
} 	
public !
WebGoatFatalException $
($ %
string% +
?+ ,
message- 4
,4 5
	Exception6 ?
?? @
innerExceptionA O
)O P
:Q R
baseS W
(W X
messageX _
,_ `
innerExceptiona o
)o p
{ 	
} 	
} 
} ±
[C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Exceptions\WebGoatModelException.cs
	namespace 	
WebGoatCore
 
. 

Exceptions  
{ 
public 

class !
WebGoatModelException &
:' ($
AbstractWebGoatException) A
{ 
public !
WebGoatModelException $
($ %
)% &
{		 	
}

 	
public !
WebGoatModelException $
($ %
string% +
?+ ,
message- 4
)4 5
:6 7
base8 <
(< =
message= D
)D E
{ 	
} 	
public !
WebGoatModelException $
($ %
SerializationInfo% 6
info7 ;
,; <
StreamingContext= M
contextN U
)U V
:W X
baseY ]
(] ^
info^ b
,b c
contextd k
)k l
{ 	
} 	
public !
WebGoatModelException $
($ %
string% +
?+ ,
message- 4
,4 5
	Exception6 ?
?? @
innerExceptionA O
)O P
:Q R
baseS W
(W X
messageX _
,_ `
innerExceptiona o
)o p
{ 	
} 	
} 
} Ω
]C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Exceptions\WebGoatStartupException.cs
	namespace 	
WebGoatCore
 
. 

Exceptions  
{ 
public 

class #
WebGoatStartupException (
:) *$
AbstractWebGoatException+ C
{ 
public #
WebGoatStartupException &
(& '
)' (
{		 	
}

 	
public #
WebGoatStartupException &
(& '
string' -
?- .
message/ 6
)6 7
:8 9
base: >
(> ?
message? F
)F G
{ 	
} 	
public #
WebGoatStartupException &
(& '
SerializationInfo' 8
info9 =
,= >
StreamingContext? O
contextP W
)W X
:Y Z
base[ _
(_ `
info` d
,d e
contextf m
)m n
{ 	
} 	
public #
WebGoatStartupException &
(& '
string' -
?- .
message/ 6
,6 7
	Exception8 A
?A B
innerExceptionC Q
)Q R
:S T
baseU Y
(Y Z
messageZ a
,a b
innerExceptionc q
)q r
{ 	
} 	
} 
} ˇ	
KC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\BlogEntry.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
	BlogEntry 
{ 
public		 
int		 
Id		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 
string

 
Title

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
DateTime 

PostedDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Contents 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Author 
{ 
get "
;" #
set$ '
;' (
}) *
public 
virtual 
IList 
< 
BlogResponse )
>) *
	Responses+ 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
} 
} ÷	
NC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\BlogResponse.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
BlogResponse 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public		 
int		 
BlogEntryId		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
DateTime

 
ResponseDate

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
public 
string 
Author 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Contents 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
virtual 
	BlogEntry  
	BlogEntry! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} Ò
FC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Cart.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Cart 
{ 
public		 
IDictionary		 
<		 
int		 
,		 
OrderDetail		  +
>		+ ,
OrderDetails		- 9
{		: ;
get		< ?
;		? @
set		A D
;		D E
}		F G
public 
decimal 
SubTotal 
=>  "
OrderDetails 
. 
Values 
.  
Sum  #
(# $
od$ &
=>' )
od* ,
., -
ExtendedPrice- :
): ;
;; <
public 
Cart 
( 
) 
{ 	
OrderDetails 
= 
new 

Dictionary )
<) *
int* -
,- .
OrderDetail/ :
>: ;
(; <
)< =
;= >
} 	
} 
} ﬁ
JC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Category.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Category 
{ 
public 
int 

CategoryId 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
CategoryName		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public

 
string

 
?

 
Description

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
virtual 
IList 
< 
Product $
>$ %
Products& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} Ãá
LC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\CreditCard.cs
	namespace		 	
WebGoatCore		
 
.		 
Models		 
{

 
public 

class 

CreditCard 
{ 
public 
string 
Filename 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
Expiry 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
ExpiryMonth 
=> !
Expiry" (
.( )
Month) .
;. /
public 
int 

ExpiryYear 
=>  
Expiry! '
.' (
Year( ,
;, -
public 

CreditCard 
( 
) 
{ 	
Filename 
= 
string 
. 
Empty #
;# $
Username 
= 
string 
. 
Empty #
;# $
Number 
= 
string 
. 
Empty !
;! "
} 	
public!! 
void!! 
GetCardForUser!! "
(!!" #
)!!# $
{"" 	
	XDocument## 
document## 
=##  
ReadCreditCardFile##! 3
(##3 4
)##4 5
;##5 6
try$$ 
{%% 
XElement&& 
?&& 
	ccElement&& #
=&&$ %#
GetCreditCardXmlElement&&& =
(&&= >
document&&> F
)&&F G
;&&G H
if(( 
((( 
	ccElement(( 
!=(( 
null((  $
)(($ %
{)) 
var** 
userNameElement** '
=**( )
	ccElement*** 3
.**3 4
Element**4 ;
(**; <
$str**< F
)**F G
;**G H
if++ 
(++ 
userNameElement++ '
!=++( *
null+++ /
)++/ 0
{,, 
Username--  
=--! "
userNameElement--# 2
.--2 3
Value--3 8
;--8 9
}.. 
var00 
expiryElement00 %
=00& '
	ccElement00( 1
.001 2
Element002 9
(009 :
$str00: B
)00B C
;00C D
if11 
(11 
expiryElement11 %
!=11& (
null11) -
)11- .
{22 
Expiry33 
=33  
Convert33! (
.33( )

ToDateTime33) 3
(333 4
expiryElement334 A
.33A B
Value33B G
)33G H
;33H I
}44 
var66 
numberElement66 %
=66& '
	ccElement66( 1
.661 2
Element662 9
(669 :
$str66: B
)66B C
;66C D
if77 
(77 
numberElement77 %
!=77& (
null77) -
)77- .
{88 
Number99 
=99  
numberElement99! .
.99. /
Value99/ 4
;994 5
}:: 
};; 
}<< 
catch== 
(== $
IndexOutOfRangeException== +
)==+ ,
{>> #
CreateNewCreditCardFile?? '
(??' (
)??( )
;??) *
}@@ 
catchAA 
(AA 
XmlExceptionAA 
)AA  
{BB #
CreateNewCreditCardFileCC '
(CC' (
)CC( )
;CC) *
}DD 
}EE 	
privateGG 
XElementGG 
?GG #
GetCreditCardXmlElementGG 1
(GG1 2
	XDocumentGG2 ;
documentGG< D
)GGD E
{HH 	
varII 
	ccElementII 
=II 
documentII $
.II$ %
DescendantsII% 0
(II0 1
$strII1 =
)II= >
.II> ?
FirstOrDefaultII? M
(IIM N
cIIN O
=>IIP R
{JJ 
varKK 
userNameElementKK #
=KK$ %
cKK& '
.KK' (
ElementKK( /
(KK/ 0
$strKK0 :
)KK: ;
;KK; <
returnMM 
userNameElementMM &
!=MM' )
nullMM* .
&&MM/ 1
userNameElementMM2 A
.MMA B
ValueMMB G
.MMG H
EqualsMMH N
(MMN O
UsernameMMO W
)MMW X
;MMX Y
}NN 
)NN 
;NN 
ifOO 
(OO 
	ccElementOO 
!=OO 
nullOO !
&&OO" $
	ccElementOO% .
.OO. /
HasElementsOO/ :
)OO: ;
{PP 
returnQQ 
	ccElementQQ  
;QQ  !
}RR 
returnSS 
nullSS 
;SS 
}TT 	
publicVV 
voidVV 
SaveCardForUserVV #
(VV# $
)VV$ %
{WW 	
ifXX 
(XX 
CardExistsForUserXX !
(XX! "
)XX" #
)XX# $
{YY 
UpdateCardForUserZZ !
(ZZ! "
)ZZ" #
;ZZ# $
}[[ 
else\\ 
{]] 
InsertCardForUser^^ !
(^^! "
)^^" #
;^^# $
}__ 
}`` 	
publichh 
boolhh 
IsValidhh 
(hh 
)hh 
{ii 	
ifjj 
(jj 
Expiryjj 
<jj 
DateTimejj !
.jj! "
Todayjj" '
||jj( *
stringjj+ 1
.jj1 2
IsNullOrEmptyjj2 ?
(jj? @
thisjj@ D
.jjD E
NumberjjE K
)jjK L
)jjL M
{kk 
returnll 
falsell 
;ll 
}mm 
varpp 
creditCardNumberpp  
=pp! "
Regexpp# (
.pp( )
Replacepp) 0
(pp0 1
Numberpp1 7
,pp7 8
$strpp9 A
,ppA B
$strppC E
)ppE F
;ppF G
ifss 
(ss 
stringss 
.ss 
IsNullOrEmptyss $
(ss$ %
creditCardNumberss% 5
)ss5 6
||ss7 9
creditCardNumberss: J
.ssJ K
LengthssK Q
<ssR S
$numssT V
)ssV W
{tt 
returnuu 
falseuu 
;uu 
}vv 
varxx 
numberxx 
=xx 
creditCardNumberxx )
.xx) *
ToCharArrayxx* 5
(xx5 6
)xx6 7
;xx7 8
int|| 
sum|| 
=|| 
$num|| 
;|| 
for}} 
(}} 
int}} 
i}} 
=}} 
number}} 
.}}  
Length}}  &
-}}' (
$num}}) *
;}}* +
i}}, -
>=}}. 0
$num}}1 2
;}}2 3
i}}4 5
--}}5 7
)}}7 8
{~~ 
if 
( 
i 
% 
$num 
== 
number #
.# $
Length$ *
%+ ,
$num- .
). /
{
ÄÄ 
int
ÅÅ 
n
ÅÅ 
=
ÅÅ 
(
ÅÅ 
number
ÅÅ #
[
ÅÅ# $
i
ÅÅ$ %
]
ÅÅ% &
-
ÅÅ' (
$char
ÅÅ) ,
)
ÅÅ, -
*
ÅÅ. /
$num
ÅÅ0 1
;
ÅÅ1 2
sum
ÇÇ 
+=
ÇÇ 
(
ÇÇ 
n
ÇÇ 
/
ÇÇ 
$num
ÇÇ  "
)
ÇÇ" #
+
ÇÇ$ %
(
ÇÇ& '
n
ÇÇ' (
%
ÇÇ) *
$num
ÇÇ+ -
)
ÇÇ- .
;
ÇÇ. /
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
sum
ÜÜ 
+=
ÜÜ 
(
ÜÜ 
number
ÜÜ "
[
ÜÜ" #
i
ÜÜ# $
]
ÜÜ$ %
-
ÜÜ& '
$char
ÜÜ( +
)
ÜÜ+ ,
;
ÜÜ, -
}
áá 
}
àà 
return
ââ 
(
ââ 
sum
ââ 
%
ââ 
$num
ââ 
==
ââ 
$num
ââ  !
)
ââ! "
;
ââ" #
}
ää 	
public
åå 
string
åå 

ChargeCard
åå  
(
åå  !
decimal
åå! (
amount
åå) /
)
åå/ 0
{
çç 	
var
èè 
code
èè 
=
èè 
new
èè 
Random
èè !
(
èè! "
)
èè" #
.
èè# $
Next
èè$ (
(
èè( )
$num
èè) /
)
èè/ 0
.
èè0 1
ToString
èè1 9
(
èè9 :
$str
èè: B
)
èèB C
;
èèC D
return
êê 
code
êê 
;
êê 
}
ëë 	
private
ïï 
	XDocument
ïï  
ReadCreditCardFile
ïï ,
(
ïï, -
)
ïï- .
{
ññ 	
var
óó 
document
óó 
=
óó 
new
óó 
	XDocument
óó (
(
óó( )
)
óó) *
;
óó* +
try
òò 
{
ôô 
using
öö 
(
öö 

FileStream
öö !

readStream
öö" ,
=
öö- .
File
öö/ 3
.
öö3 4
Open
öö4 8
(
öö8 9
Filename
öö9 A
,
ööA B
FileMode
ööC K
.
ööK L
Open
ööL P
)
ööP Q
)
ööQ R
{
õõ 
var
úú 
xr
úú 
=
úú 
new
úú  
XmlTextReader
úú! .
(
úú. /

readStream
úú/ 9
)
úú9 :
;
úú: ;
document
ùù 
=
ùù 
	XDocument
ùù (
.
ùù( )
Load
ùù) -
(
ùù- .
xr
ùù. 0
)
ùù0 1
;
ùù1 2
xr
ûû 
.
ûû 
Close
ûû 
(
ûû 
)
ûû 
;
ûû 
}
üü 
}
†† 
catch
°° 
(
°° #
FileNotFoundException
°° (
)
°°( )
{
¢¢ %
CreateNewCreditCardFile
££ '
(
££' (
)
££( )
;
££) *
}
§§ 
catch
•• 
(
•• 
XmlException
•• 
)
••  
{
¶¶ %
CreateNewCreditCardFile
ßß '
(
ßß' (
)
ßß( )
;
ßß) *
}
®® 
return
©© 
document
©© 
;
©© 
}
™™ 	
private
¨¨ 
void
¨¨ !
WriteCreditCardFile
¨¨ (
(
¨¨( )
	XDocument
¨¨) 2
xmlDocument
¨¨3 >
)
¨¨> ?
{
≠≠ 	
try
ÆÆ 
{
ØØ 
using
∞∞ 
(
∞∞ 
var
∞∞ 
writeStream
∞∞ &
=
∞∞' (
File
∞∞) -
.
∞∞- .
Open
∞∞. 2
(
∞∞2 3
Filename
∞∞3 ;
,
∞∞; <
FileMode
∞∞= E
.
∞∞E F
Create
∞∞F L
)
∞∞L M
)
∞∞M N
{
±± 
var
≤≤ 
writer
≤≤ 
=
≤≤  
new
≤≤! $
StreamWriter
≤≤% 1
(
≤≤1 2
writeStream
≤≤2 =
)
≤≤= >
;
≤≤> ?
xmlDocument
≥≥ 
.
≥≥  
Save
≥≥  $
(
≥≥$ %
writer
≥≥% +
)
≥≥+ ,
;
≥≥, -
writer
¥¥ 
.
¥¥ 
Close
¥¥  
(
¥¥  !
)
¥¥! "
;
¥¥" #
}
µµ 
}
∂∂ 
catch
∑∑ 
(
∑∑ #
FileNotFoundException
∑∑ (
)
∑∑( )
{
∏∏ %
CreateNewCreditCardFile
ππ '
(
ππ' (
)
ππ( )
;
ππ) *
}
∫∫ 
catch
ªª 
(
ªª &
IndexOutOfRangeException
ªª +
)
ªª+ ,
{
ºº %
CreateNewCreditCardFile
ΩΩ '
(
ΩΩ' (
)
ΩΩ( )
;
ΩΩ) *
}
ææ 
catch
øø 
(
øø 
XmlException
øø 
)
øø  
{
¿¿ %
CreateNewCreditCardFile
¡¡ '
(
¡¡' (
)
¡¡( )
;
¡¡) *
}
¬¬ 
}
√√ 	
private
≈≈ 
bool
≈≈ 
CardExistsForUser
≈≈ &
(
≈≈& '
)
≈≈' (
{
∆∆ 	
var
«« 
document
«« 
=
««  
ReadCreditCardFile
«« -
(
««- .
)
««. /
;
««/ 0
var
»» 
element
»» 
=
»» %
GetCreditCardXmlElement
»» 1
(
»»1 2
document
»»2 :
)
»»: ;
;
»»; <
return
…… 
element
…… 
!=
…… 
null
…… "
;
……" #
}
   	
private
ÃÃ 
void
ÃÃ %
CreateNewCreditCardFile
ÃÃ ,
(
ÃÃ, -
)
ÃÃ- .
{
ÕÕ 	
var
ŒŒ 
document
ŒŒ 
=
ŒŒ 
new
ŒŒ 
	XDocument
ŒŒ (
(
ŒŒ( )
)
ŒŒ) *
;
ŒŒ* +
document
œœ 
.
œœ 
Add
œœ 
(
œœ 
new
œœ 
XElement
œœ %
(
œœ% &
$str
œœ& 3
)
œœ3 4
)
œœ4 5
;
œœ5 6!
WriteCreditCardFile
–– 
(
––  
document
––  (
)
––( )
;
––) *
}
—— 	
private
”” 
void
”” 
UpdateCardForUser
”” &
(
””& '
)
””' (
{
‘‘ 	
	XDocument
’’ 
document
’’ 
=
’’   
ReadCreditCardFile
’’! 3
(
’’3 4
)
’’4 5
;
’’5 6
XElement
÷÷ 
?
÷÷ 
	ccElement
÷÷ 
=
÷÷  !%
GetCreditCardXmlElement
÷÷" 9
(
÷÷9 :
document
÷÷: B
)
÷÷B C
;
÷÷C D
if
ÿÿ 
(
ÿÿ 
	ccElement
ÿÿ 
!=
ÿÿ 
null
ÿÿ  
)
ÿÿ  !
{
ŸŸ 
var
⁄⁄ 
expiryElement
⁄⁄ !
=
⁄⁄" #
	ccElement
⁄⁄$ -
.
⁄⁄- .
Element
⁄⁄. 5
(
⁄⁄5 6
$str
⁄⁄6 >
)
⁄⁄> ?
;
⁄⁄? @
if
€€ 
(
€€ 
expiryElement
€€ !
!=
€€" $
null
€€% )
)
€€) *
{
‹‹ 
expiryElement
›› !
.
››! "
Value
››" '
=
››( )
Expiry
››* 0
.
››0 1
ToString
››1 9
(
››9 :
)
››: ;
;
››; <
}
ﬁﬁ 
var
‡‡ 
numberElement
‡‡ !
=
‡‡" #
	ccElement
‡‡$ -
.
‡‡- .
Element
‡‡. 5
(
‡‡5 6
$str
‡‡6 >
)
‡‡> ?
;
‡‡? @
if
·· 
(
·· 
numberElement
·· !
!=
··" $
null
··% )
)
··) *
{
‚‚ 
numberElement
„„ !
.
„„! "
Value
„„" '
=
„„( )
Number
„„* 0
;
„„0 1
}
‰‰ !
WriteCreditCardFile
ÊÊ #
(
ÊÊ# $
document
ÊÊ$ ,
)
ÊÊ, -
;
ÊÊ- .
}
ÁÁ 
else
ËË 
{
ÈÈ 
throw
ÍÍ 
new
ÍÍ 0
"WebGoatCreditCardNotFoundException
ÍÍ <
(
ÍÍ< =
string
ÍÍ= C
.
ÍÍC D
Format
ÍÍD J
(
ÍÍJ K
$str
ÍÍK c
,
ÍÍc d
Username
ÍÍe m
)
ÍÍm n
)
ÍÍn o
;
ÍÍo p
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ 
InsertCardForUser
ÓÓ &
(
ÓÓ& '
)
ÓÓ' (
{
ÔÔ 	
	XDocument
 
document
 
=
   
ReadCreditCardFile
! 3
(
3 4
)
4 5
;
5 6
var
ÒÒ 
root
ÒÒ 
=
ÒÒ 
document
ÒÒ 
.
ÒÒ  
Root
ÒÒ  $
;
ÒÒ$ %
if
ÚÚ 
(
ÚÚ 
root
ÚÚ 
!=
ÚÚ 
null
ÚÚ 
)
ÚÚ 
{
ÛÛ 
root
ÙÙ 
.
ÙÙ 
Add
ÙÙ 
(
ÙÙ 
new
ÙÙ 
XElement
ÙÙ %
(
ÙÙ% &
$str
ÙÙ& 2
,
ÙÙ2 3
new
ıı 
XElement
ıı  
(
ıı  !
$str
ıı! +
,
ıı+ ,
Username
ıı- 5
)
ıı5 6
,
ıı6 7
new
ˆˆ 
XElement
ˆˆ  
(
ˆˆ  !
$str
ˆˆ! )
,
ˆˆ) *
Number
ˆˆ+ 1
)
ˆˆ1 2
,
ˆˆ2 3
new
˜˜ 
XElement
˜˜  
(
˜˜  !
$str
˜˜! )
,
˜˜) *
Expiry
˜˜+ 1
)
˜˜1 2
)
¯¯ 
)
¯¯ 
;
¯¯ !
WriteCreditCardFile
˘˘ #
(
˘˘# $
document
˘˘$ ,
)
˘˘, -
;
˘˘- .
}
˙˙ 
else
˚˚ 
{
¸¸ 
throw
˛˛ 
new
˛˛ #
WebGoatFatalException
˛˛ /
(
˛˛/ 0
$str
˛˛0 T
)
˛˛T U
;
˛˛U V
}
ˇˇ 
}
ÄÄ 	
}
ÇÇ 
}ÉÉ º
JC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Customer.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Customer 
{ 
public 
string 

CustomerId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ContactName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
?		 
ContactTitle		 #
{		$ %
get		& )
;		) *
set		+ .
;		. /
}		0 1
public

 
string

 
?

 
Address

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
? 
City 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Region 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 

PostalCode !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Country 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Phone 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Fax 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ß0
GC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Order.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public		 

class		 
Order		 
{

 
public 
int 
OrderId 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

CustomerId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
? 

EmployeeId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
DateTime 
	OrderDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
RequiredDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
ShippedDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
ShipVia 
{ 
get  
;  !
set" %
;% &
}' (
public 
decimal 
Freight 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
ShipName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
ShipAddress "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
ShipCity 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 

ShipRegion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
ShipPostalCode %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
ShipCountry "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
virtual 
IList 
< 
OrderDetail (
>( )
OrderDetails* 6
{7 8
get9 <
;< =
set> A
;A B
}C D
public 
virtual 
Customer 
Customer  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
virtual 
IList 
< 
OrderPayment )
>) *
OrderPayments+ 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
virtual 
Shipment 
?  
Shipment! )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
decimal 
SubTotal 
=>  "
OrderDetails# /
./ 0
Sum0 3
(3 4
od4 6
=>7 9
od: <
.< =
ExtendedPrice= J
)J K
;K L
public!! 
decimal!! 
Total!! 
=>!! 
Math!!  $
.!!$ %
Round!!% *
(!!* +
SubTotal!!+ 3
+!!4 5
Freight!!6 =
,!!= >
$num!!? @
)!!@ A
;!!A B
public## 
static## 
string## !
GetPackageTrackingUrl## 2
(##2 3
string##3 9
Carrier##: A
,##A B
string##C I
TrackingNumber##J X
)##X Y
{$$ 	
string%% 
trackingUrl%% 
;%% 
Carrier&& 
=&& 
Carrier&& 
.&& 
ToLower&& %
(&&% &
)&&& '
;&&' (
switch'' 
('' 
Carrier'' 
)'' 
{(( 
case)) 
$str)) 
:)) 
case** 
$str** %
:**% &
case++ 
$str++ &
:++& '
trackingUrl,, 
=,,  !
string,," (
.,,( )
Format,,) /
(,,/ 0
$str,,0 m
,,,m n
TrackingNumber,,o }
),,} ~
;,,~ 
break-- 
;-- 
case.. 
$str.. 
:.. 
case// 
$str// *
://* +
case00 
$str00 ,
:00, -
trackingUrl22 
=22  !
string22" (
.22( )
Format22) /
(22/ 0
$str	220 Ä
,
22Ä Å
TrackingNumber
22Ç ê
)
22ê ë
;
22ë í
break33 
;33 
case44 
$str44 
:44 
case55 
$str55 0
:550 1
case66 
$str66 3
:663 4
case77 
$str77 !
:77! "
case88 
$str88 "
:88" #
trackingUrl99 
=99  !
string99" (
.99( )
Format99) /
(99/ 0
$str	990 Ñ
,
99Ñ Ö
TrackingNumber
99Ü î
)
99î ï
;
99ï ñ
break:: 
;:: 
default;; 
:;; 
trackingUrl<< 
=<<  !
string<<" (
.<<( )
Format<<) /
(<</ 0
$str<<0 O
,<<O P
Carrier<<Q X
,<<X Y
TrackingNumber<<Z h
)<<h i
;<<i j
break== 
;== 
}>> 
return?? 
trackingUrl?? 
;?? 
}@@ 	
}AA 
}BB ∑
MC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\OrderDetail.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
OrderDetail 
{ 
public		 
int		 
OrderId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
int

 
	ProductId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
double 
	UnitPrice 
{  !
get" %
;% &
set' *
;* +
}, -
public 
short 
Quantity 
{ 
get  #
;# $
set% (
;( )
}* +
public 
float 
Discount 
{ 
get  #
;# $
set% (
;( )
}* +
public 
virtual 
Order 
Order "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
virtual 
Product 
Product &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
decimal 
DecimalUnitPrice '
=>( *
Convert+ 2
.2 3
	ToDecimal3 <
(< =
this= A
.A B
	UnitPriceB K
)K L
;L M
public 
decimal 
ExtendedPrice $
=>% '
DecimalUnitPrice( 8
*9 :
Convert; B
.B C
	ToDecimalC L
(L M
$numM N
-O P
DiscountQ Y
)Y Z
*[ \
Quantity] e
;e f
} 
} À
NC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\OrderPayment.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
OrderPayment 
{ 
public 
int 
OrderPaymentId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
int		 
OrderId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
CreditCardNumber

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
DateTime 
ExpirationDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 
CVV 
{ 
get  
;  !
set" %
;% &
}' (
public 
double 

AmountPaid  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
PaymentDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
ApprovalCode "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
virtual 
Order 
Order "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ø
IC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Product.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Product 
{ 
[		 	
Display			 
(		 
Name		 
=		 
$str		 %
)		% &
]		& '
public

 
int

 
	ProductId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
[ 	
Display	 
( 
Name 
= 
$str '
)' (
]( )
public 
string 
ProductName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 

SupplierId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 

CategoryId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Display	 
( 
Name 
= 
$str ,
), -
]- .
public 
string 
QuantityPerUnit %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
Display	 
( 
Name 
= 
$str %
)% &
]& '
public 
double 
	UnitPrice 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Display	 
( 
Name 
= 
$str )
)) *
]* +
public 
short 
UnitsInStock !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str )
)) *
]* +
public 
short 
UnitsOnOrder !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str (
)( )
]) *
public 
short 
ReorderLevel !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
public 
bool 
Discontinued  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Display	 
( 
Name 
= 
$str #
)# $
]$ %
public 
virtual 
Category 
Category  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	
Display	 
( 
Name 
= 
$str #
)# $
]$ %
public 
virtual 
Supplier 
Supplier  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public!! 
decimal!! 
DecimalUnitPrice!! '
=>!!( *
Convert!!+ 2
.!!2 3
	ToDecimal!!3 <
(!!< =
this!!= A
.!!A B
	UnitPrice!!B K
)!!K L
;!!L M
}"" 
}## Å
JC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Shipment.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Shipment 
{ 
public 
int 

ShipmentId 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
int		 
OrderId		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
int

 
	ShipperId

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
DateTime 
ShipmentDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
TrackingNumber $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
virtual 
Order 
Order "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
virtual 
Shipper 
Shipper &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ù
IC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Shipper.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Shipper 
{ 
public 
int 
	ShipperId 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
CompanyName		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
ServiceName

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
double "
ShippingCostMultiplier ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
public 
decimal 
GetShippingCost &
(& '
decimal' .
subTotal/ 7
)7 8
{ 	
return 
subTotal 
* 
Convert %
.% &
	ToDecimal& /
(/ 0"
ShippingCostMultiplier0 F
)F G
;G H
} 	
} 
} «
JC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Models\Supplier.cs
	namespace 	
WebGoatCore
 
. 
Models 
{ 
public 

class 
Supplier 
{ 
public 
int 

SupplierId 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
CompanyName		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
ContactName

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
string 
? 
ContactTitle #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
? 
Address 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
City 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Region 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 

PostalCode !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Country 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Phone 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Fax 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
HomePage 
{  !
get" %
;% &
set' *
;* +
}, -
public 
virtual 
IList 
< 
Product $
>$ %
Products& .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} õ

BC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Program.cs
	namespace 	
WebGoatCore
 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{		 	
CreateHostBuilder

 
(

 
args

 "
)

" #
.

# $
Build

$ )
(

) *
)

* +
.

+ ,
Run

, /
(

/ 0
)

0 1
;

1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} ≈_
BC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Startup.cs
	namespace 	
WebGoatCore
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
,3 4
IWebHostEnvironment5 H
envI L
)L M
{ 	
var 
execDirectory 
= 
GetExecDirectory  0
(0 1
)1 2
;2 3
var 
builder 
= 
new  
ConfigurationBuilder 2
(2 3
)3 4
;4 5
var 
dic 
= 
new 

Dictionary $
<$ %
string% +
,+ ,
string- 3
>3 4
{ 
{ 
	Constants 
. 
WEBGOAT_ROOT '
,' (
execDirectory) 6
}6 7
,7 8
} 
; 
builder   
.   !
AddInMemoryCollection   )
(  ) *
dic  * -
)  - .
;  . /
builder!! 
.!! 
AddConfiguration!! $
(!!$ %
configuration!!% 2
)!!2 3
;!!3 4
Configuration"" 
="" 
builder"" #
.""# $
Build""$ )
("") *
)""* +
;""+ ,
env$$ 
.$$ 
WebRootFileProvider$$ #
=$$$ %
new$$& )!
CompositeFileProvider$$* ?
($$? @
env%% 
.%% 
WebRootFileProvider%% '
,%%' (
new%%) , 
PhysicalFileProvider%%- A
(%%A B
Path%%B F
.%%F G
Combine%%G N
(%%N O
execDirectory%%O \
,%%\ ]
$str%%^ g
)%%g h
)%%h i
)&& 
;&& 
NorthwindContext(( 
.(( 

Initialize(( '
(((' (
this((( ,
.((, -
Configuration((- :
,((: ;
env((< ?
)((? @
;((@ A
})) 	
private++ 
static++ 
string++ 
GetExecDirectory++ .
(++. /
)++/ 0
{,, 	
string-- 
?-- 
entryDir-- 
=-- 
null-- #
;--# $
string.. 
?.. 
entryLocation.. !
=.." #
Assembly..$ ,
..., -
GetEntryAssembly..- =
(..= >
)..> ?
?..? @
...@ A
Location..A I
;..I J
if// 
(// 
!// 
string// 
.// 
IsNullOrEmpty// $
(//$ %
entryLocation//% 2
)//2 3
)//3 4
{00 
entryDir11 
=11 
Path11 
.11  
GetDirectoryName11  0
(110 1
entryLocation111 >
)11> ?
;11? @
}22 
if33 
(33 
!33 
string33 
.33 
IsNullOrEmpty33 $
(33$ %
entryDir33% -
)33- .
)33. /
{44 
return55 
entryDir55 
;55  
}66 
throw77 
new77 #
WebGoatStartupException77 -
(77- .
$str77. V
)77V W
;77W X
}88 	
public:: 
IConfiguration:: 
Configuration:: +
{::, -
get::. 1
;::1 2
}::3 4
public<< 
void<< 
ConfigureServices<< %
(<<% &
IServiceCollection<<& 8
services<<9 A
)<<A B
{== 	
services>> 
.>> #
AddControllersWithViews>> ,
(>>, -
)>>- .
.?? &
AddRazorRuntimeCompilation?? +
(??+ ,
)??, -
;??- .
servicesAA 
.AA 
AddDbContextAA !
<AA! "
NorthwindContextAA" 2
>AA2 3
(AA3 4
optionsAA4 ;
=>AA< >
optionsBB 
.BB 
	UseSqliteBB !
(BB! "
NorthwindContextBB" 2
.BB2 3

ConnStringBB3 =
)BB= >
.CC !
UseLazyLoadingProxiesCC *
(CC* +
)CC+ ,
,CC, -
ServiceLifetimeDD 
.DD  
ScopedDD  &
)DD& '
;DD' (
servicesFF 
.FF 
AddDefaultIdentityFF '
<FF' (
IdentityUserFF( 4
>FF4 5
(FF5 6
)FF6 7
.GG 
AddRolesGG 
<GG 
IdentityRoleGG &
>GG& '
(GG' (
)GG( )
.HH $
AddEntityFrameworkStoresHH )
<HH) *
NorthwindContextHH* :
>HH: ;
(HH; <
)HH< =
;HH= >
servicesJJ 
.JJ 
	ConfigureJJ 
<JJ 
IdentityOptionsJJ .
>JJ. /
(JJ/ 0
optionsJJ0 7
=>JJ8 :
{KK 
optionsMM 
.MM 
PasswordMM  
.MM  !
RequireDigitMM! -
=MM. /
falseMM0 5
;MM5 6
optionsNN 
.NN 
PasswordNN  
.NN  !
RequireLowercaseNN! 1
=NN2 3
falseNN4 9
;NN9 :
optionsOO 
.OO 
PasswordOO  
.OO  !"
RequireNonAlphanumericOO! 7
=OO8 9
falseOO: ?
;OO? @
optionsPP 
.PP 
PasswordPP  
.PP  !
RequireUppercasePP! 1
=PP2 3
falsePP4 9
;PP9 :
optionsQQ 
.QQ 
PasswordQQ  
.QQ  !
RequiredLengthQQ! /
=QQ0 1
$numQQ2 3
;QQ3 4
optionsRR 
.RR 
PasswordRR  
.RR  !
RequiredUniqueCharsRR! 4
=RR5 6
$numRR7 8
;RR8 9
optionsUU 
.UU 
LockoutUU 
.UU  "
DefaultLockoutTimeSpanUU  6
=UU7 8
TimeSpanUU9 A
.UUA B
FromMinutesUUB M
(UUM N
$numUUN O
)UUO P
;UUP Q
optionsVV 
.VV 
LockoutVV 
.VV  #
MaxFailedAccessAttemptsVV  7
=VV8 9
$numVV: ;
;VV; <
optionsWW 
.WW 
LockoutWW 
.WW  
AllowedForNewUsersWW  2
=WW3 4
falseWW5 :
;WW: ;
optionsZZ 
.ZZ 
UserZZ 
.ZZ %
AllowedUserNameCharactersZZ 6
=ZZ7 8
$str	ZZ9 Ç
;
ZZÇ É
}[[ 
)[[ 
;[[ 
services]] 
.]] &
ConfigureApplicationCookie]] /
(]]/ 0
options]]0 7
=>]]8 :
{^^ 
options`` 
.`` 
Cookie`` 
.`` 
HttpOnly`` '
=``( )
false``* /
;``/ 0
optionsaa 
.aa 
ExpireTimeSpanaa &
=aa' (
TimeSpanaa) 1
.aa1 2
FromMinutesaa2 =
(aa= >
$numaa> ?
)aa? @
;aa@ A
optionscc 
.cc 
	LoginPathcc !
=cc" #
$strcc$ 4
;cc4 5
optionsdd 
.dd 
AccessDeniedPathdd (
=dd) *
$strdd+ B
;ddB C
optionsee 
.ee 
SlidingExpirationee )
=ee* +
trueee, 0
;ee0 1
}ff 
)ff 
;ff 
serviceshh 
.hh %
AddDistributedMemoryCachehh .
(hh. /
)hh/ 0
;hh0 1
servicesjj 
.jj 

AddSessionjj 
(jj  
optionsjj  '
=>jj( *
{kk 
optionsll 
.ll 
Cookiell 
.ll 
HttpOnlyll '
=ll( )
falsell* /
;ll/ 0
optionsmm 
.mm 
IdleTimeoutmm #
=mm$ %
TimeSpanmm& .
.mm. /
	FromHoursmm/ 8
(mm8 9
$nummm9 :
)mm: ;
;mm; <
}nn 
)nn 
;nn 
JsonConvertpp 
.pp 
DefaultSettingspp '
=pp( )
(pp* +
)pp+ ,
=>pp- /
newpp0 3"
JsonSerializerSettingspp4 J
{qq &
PreserveReferencesHandlingrr *
=rr+ ,&
PreserveReferencesHandlingrr- G
.rrG H
ObjectsrrH O
}ss 
;ss 
servicesuu 
.uu 
	AddScopeduu 
<uu 
CustomerRepositoryuu 1
>uu1 2
(uu2 3
)uu3 4
;uu4 5
servicesvv 
.vv 
	AddScopedvv 
<vv 
ProductRepositoryvv 0
>vv0 1
(vv1 2
)vv2 3
;vv3 4
servicesww 
.ww 
	AddScopedww 
<ww 
BlogEntryRepositoryww 2
>ww2 3
(ww3 4
)ww4 5
;ww5 6
servicesxx 
.xx 
	AddScopedxx 
<xx "
BlogResponseRepositoryxx 5
>xx5 6
(xx6 7
)xx7 8
;xx8 9
servicesyy 
.yy 
	AddScopedyy 
<yy 
ShipperRepositoryyy 0
>yy0 1
(yy1 2
)yy2 3
;yy3 4
serviceszz 
.zz 
	AddScopedzz 
<zz 
SupplierRepositoryzz 1
>zz1 2
(zz2 3
)zz3 4
;zz4 5
services{{ 
.{{ 
	AddScoped{{ 
<{{ 
OrderRepository{{ .
>{{. /
({{/ 0
){{0 1
;{{1 2
services|| 
.|| 
	AddScoped|| 
<|| 
CategoryRepository|| 1
>||1 2
(||2 3
)||3 4
;||4 5
}}} 	
public 
void 
	Configure 
( 
IApplicationBuilder 1
app2 5
,5 6
IWebHostEnvironment7 J
envK N
)N O
{
ÄÄ 	
app
ÇÇ 
.
ÇÇ '
UseDeveloperExceptionPage
ÇÇ )
(
ÇÇ) *
)
ÇÇ* +
;
ÇÇ+ ,
app
ÑÑ 
.
ÑÑ -
UseStatusCodePagesWithRedirects
ÑÑ /
(
ÑÑ/ 0
$"
ÑÑ0 2
$str
ÑÑ2 3
{
ÑÑ3 4"
StatusCodeController
ÑÑ4 H
.
ÑÑH I
NAME
ÑÑI M
}
ÑÑM N
$str
ÑÑN Y
"
ÑÑY Z
)
ÑÑZ [
;
ÑÑ[ \
app
ÜÜ 
.
ÜÜ 
UseStaticFiles
ÜÜ 
(
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
app
àà 
.
àà 

UseRouting
àà 
(
àà 
)
àà 
;
àà 
app
ää 
.
ää 
UseAuthentication
ää !
(
ää! "
)
ää" #
;
ää# $
app
ãã 
.
ãã 
UseAuthorization
ãã  
(
ãã  !
)
ãã! "
;
ãã" #
app
çç 
.
çç 

UseSession
çç 
(
çç 
)
çç 
;
çç 
app
èè 
.
èè 
UseEndpoints
èè 
(
èè 
	endpoints
èè &
=>
èè' )
{
êê 
	endpoints
ëë 
.
ëë  
MapControllerRoute
ëë ,
(
ëë, -
name
íí 
:
íí 
$str
íí #
,
íí# $
pattern
ìì 
:
ìì 
$str
ìì ?
)
ìì? @
;
ìì@ A
}
îî 
)
îî 
;
îî 
}
ïï 	
public
óó 
int
óó 
startupNotUsed
óó !
(
óó! "
int
óó" %
a
óó& '
,
óó' (
int
óó) ,
b
óó- .
)
óó. /
{
òò 	
var
ôô 
c
ôô 
=
ôô 
$num
ôô 
;
ôô 
b
öö 
=
öö 
$num
öö 
;
öö 
return
õõ 
a
õõ 
/
õõ 
b
õõ 
;
õõ 
}
úú 	
}
ùù 
}ûû ö
LC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Utils\EmailSender.cs
	namespace 	
WebGoatCore
 
{ 
public 

class 
EmailSender 
{ 
public 
static 
void 
Send 
(  
string  &
to' )
,) *
string+ 1
subject2 9
,9 :
string; A
messageBodyB M
)M N
{		 	
var

 
message

 
=

 
new

 
MailMessage

 )
(

) *
$str

* I
,

I J
to

K M
)

M N
{ 
Subject 
= 
subject !
,! "

IsBodyHtml 
= 
true !
,! "
Body 
= 
messageBody "
," #
} 
; 
var 
client 
= 
new 

SmtpClient '
(' (
)( )
{* +
	EnableSsl, 5
=6 7
true8 <
}= >
;> ?
try 
{ 
client 
. 
Send 
( 
message #
)# $
;$ %
} 
catch 
( 
	Exception 
) 
{ 
throw 
; 
} 
} 	
public 
static 
void 
Send 
(  
MailMessage  +
message, 3
)3 4
{ 	
var 
client 
= 
new 

SmtpClient '
(' (
)( )
{* +
	EnableSsl, 5
=6 7
true8 <
}= >
;> ?
try 
{ 
client   
.   
Send   
(   
message   #
)  # $
;  $ %
}!! 
catch"" 
("" 
	Exception"" 
)"" 
{## 
throw$$ 
;$$ 
}%% 
}&& 	
}'' 
}(( —
OC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Utils\LinqExtensions.cs
	namespace 	
WebGoatCore
 
{ 
public 

static 
class 
LinqExtensions &
{		 
public

 
static

 
IEnumerable

 !
<

! "
(

" #
T

# $
item

% )
,

) *
int

+ .
index

/ 4
)

4 5
>

5 6
	WithIndex

7 @
<

@ A
T

A B
>

B C
(

C D
this

D H
IEnumerable

I T
<

T U
T

U V
>

V W
self

X \
)

\ ]
=>

^ `
self 
. 
Select 
( 
( 
item 
, 
index $
)$ %
=>& (
() *
item* .
,. /
index0 5
)5 6
)6 7
;7 8
} 
} Ë
RC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\Utils\SessionExtensions.cs
	namespace 	
WebGoatCore
 
{ 
public		 

static		 
class		 
SessionExtensions		 )
{

 
public 
static 
void 
Set 
< 
T  
>  !
(! "
this" &
ISession' /
session0 7
,7 8
string9 ?
key@ C
,C D
TE F
valueG L
)L M
{ 	
var 
s 
= 
JsonConvert 
.  
SerializeObject  /
(/ 0
value0 5
)5 6
;6 7
session 
. 
	SetString 
( 
key !
,! "
s# $
)$ %
;% &
} 	
[ 	
return	 
: 
	MaybeNull 
] 
public 
static 
T 
Get 
< 
T 
> 
( 
this #
ISession$ ,
session- 4
,4 5
string6 <
key= @
)@ A
{ 	
if 
( 
session 
. 
TryGet 
< 
T  
>  !
(! "
key" %
,% &
out' *
var+ .
value/ 4
)4 5
)5 6
{ 
return 
value 
; 
} 
return 
default 
; 
} 	
public 
static 
bool 
TryGet !
<! "
T" #
># $
($ %
this% )
ISession* 2
session3 :
,: ;
string< B
keyC F
,F G
outH K
TL M
?M N
valueO T
)T U
{ 	
var 
str 
= 
session 
. 
	GetString '
(' (
key( +
)+ ,
;, -
if 
( 
str 
== 
null 
) 
{   
value!! 
=!! 
default!! 
;!!  
return"" 
false"" 
;"" 
}## 
value%% 
=%% 
JsonConvert%% 
.%%  
DeserializeObject%%  1
<%%1 2
T%%2 3
>%%3 4
(%%4 5
str%%5 8
)%%8 9
;%%9 :
return&& 
true&& 
;&& 
}'' 	
}(( 
})) ˙
ZC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\AddUserTempViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class  
AddUserTempViewModel %
{ 
public 
bool 
IsIssuerAdmin !
{" #
get$ '
;' (
set) ,
;, -
}. /
[		 	
Display			 
(		 
Name		 
=		 
$str		 *
)		* +
]		+ ,
public

 
string

 
NewUsername

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
[ 	
Display	 
( 
Name 
= 
$str #
)# $
]$ %
public 
string 
NewPassword !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str (
)( )
]) *
public 
string 
NewEmail 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Display	 
( 
Name 
= 
$str :
): ;
]; <
public 
bool 
MakeNewUserAdmin $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
bool 
CreatedUser 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} ª
`C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ChangeAccountInfoViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class &
ChangeAccountInfoViewModel +
{ 
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
public 
string 
? 
CompanyName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[

 	
Display

	 
(

 
Name

 
=

 
$str

 '
)

' (
]

( )
public 
string 
? 
ContactTitle #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 	
Display	 
( 
Name 
= 
$str !
)! "
]" #
public 
string 
? 
Address 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Display	 
( 
Name 
= 
$str 
) 
]  
public 
string 
? 
City 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
public 
string 
? 
Region 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Display	 
( 
Name 
= 
$str %
)% &
]& '
[ 	
DataType	 
( 
DataType 
. 

PostalCode %
)% &
]& '
public 
string 
? 

PostalCode !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str !
)! "
]" #
public 
string 
? 
Country 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
UpdatedSucessfully &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
}   ⁄
]C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ChangePasswordViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class #
ChangePasswordViewModel (
{ 
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
[		 	
Required			 
(		 
ErrorMessage		 
=		  
$str		! 8
)		8 9
]		9 :
[

 	
DataType

	 
(

 
DataType

 
.

 
Text

 
)

  
]

  !
public 
string 
OldPassword !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
NewPassword !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str .
). /
]/ 0
[ 	
Required	 
( 
ErrorMessage 
=  
$str! F
)F G
]G H
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
Compare	 
( 
nameof 
( 
NewPassword #
)# $
,$ %
ErrorMessage& 2
=3 4
$str5 j
)j k
]k l
public 
string  
ConfirmedNewPassword *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} ®3
WC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\CheckoutViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
CheckoutViewModel "
{		 
[

 	
Display

	 
(

 
Name

 
=

 
$str

 )
)

) *
]

* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 8
)8 9
]9 :
public 
string 

ShipTarget  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Display	 
( 
Name 
= 
$str !
)! "
]" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 7
)7 8
]8 9
public 
string 
Address 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Display	 
( 
Name 
= 
$str 
) 
]  
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 4
)4 5
]5 6
public 
string 
City 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Region 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Display	 
( 
Name 
= 
$str %
)% &
]& '
[ 	
DataType	 
( 
DataType 
. 

PostalCode %
)% &
]& '
[ 	
Required	 
( 
ErrorMessage 
=  
$str! ;
); <
]< =
public 
string 

PostalCode  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Display	 
( 
Name 
= 
$str !
)! "
]" #
[   	
Required  	 
(   
ErrorMessage   
=    
$str  ! 7
)  7 8
]  8 9
public!! 
string!! 
Country!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
[## 	
Display##	 
(## 
Name## 
=## 
$str## )
)##) *
]##* +
[$$ 	
Required$$	 
($$ 
ErrorMessage$$ 
=$$  
$str$$! 7
)$$7 8
]$$8 9
public%% 
int%% 
ShippingMethod%% !
{%%" #
get%%$ '
;%%' (
set%%) ,
;%%, -
}%%. /
['' 	
Display''	 
('' 
Name'' 
='' 
$str'' -
)''- .
]''. /
[(( 	
DataType((	 
((( 
DataType(( 
.(( 

CreditCard(( %
,((% &
ErrorMessage((' 3
=((4 5
$str((6 a
)((a b
]((b c
[)) 	
Required))	 
()) 
ErrorMessage)) 
=))  
$str))! D
)))D E
]))E F
public** 
string** 

CreditCard**  
{**! "
get**# &
;**& '
set**( +
;**+ ,
}**- .
[,, 	
Display,,	 
(,, 
Name,, 
=,, 
$str,, $
),,$ %
],,% &
[-- 	
Required--	 
(-- 
ErrorMessage-- 
=--  
$str--! @
)--@ A
]--A B
public.. 
int.. 
ExpirationMonth.. "
{..# $
get..% (
;..( )
set..* -
;..- .
}../ 0
[00 	
Required00	 
(00 
ErrorMessage00 
=00  
$str00! ?
)00? @
]00@ A
public11 
int11 
ExpirationYear11 !
{11" #
get11$ '
;11' (
set11) ,
;11, -
}11. /
[33 	
Display33	 
(33 
Name33 
=33 
$str33 U
)33U V
]33V W
[44 	
Required44	 
(44 
ErrorMessage44 
=44  
$str44! ^
)44^ _
]44_ `
public55 
bool55 
RememberCreditCard55 &
{55' (
get55) ,
;55, -
set55. 1
;551 2
}553 4
private77 
static77 
IDictionary77 "
<77" #
int77# &
,77& '
string77( .
>77. /
_shippingOptions770 @
;77@ A
public88 
IDictionary88 
<88 
int88 
,88 
string88  &
>88& '
ShippingOptions88( 7
{888 9
get99 
{:: 
return;; 
_shippingOptions;; '
;;;' (
}<< 
set>> 
{?? 
_shippingOptions@@  
=@@! "
value@@# (
;@@( )
}AA 
}BB 	
privateDD 
staticDD 
IListDD 
<DD 
intDD  
>DD  !
	_expYearsDD" +
;DD+ ,
publicEE 
IListEE 
<EE 
intEE 
>EE $
AvailableExpirationYearsEE 2
{FF 	
getGG 
{HH 
returnII 
	_expYearsII  
;II  !
}JJ 
setLL 
{MM 
	_expYearsNN 
=NN 
valueNN !
;NN! "
}OO 
}PP 	
publicRR 
CartRR 
?RR 
CartRR 
{RR 
getRR 
;RR  
setRR! $
;RR$ %
}RR& '
}SS 
}TT ˙
TC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ErrorViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
ErrorViewModel 
{ 
public		 
string		 
	RequestId		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public (
IExceptionHandlerPathFeature +
ExceptionInfo, 9
{: ;
get< ?
;? @
setA D
;D E
}F G
} 
} ˚
SC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\HomeViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
HomeViewModel 
{ 
public		 
IEnumerable		 
<		 
Product		 "
>		" #
TopProducts		$ /
{		0 1
get		2 5
;		5 6
set		7 :
;		: ;
}		< =
}

 
} Ÿ
TC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\LoginViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
LoginViewModel 
{ 
[ 	
Display	 
( 
Name 
= 
$str #
)# $
]$ %
[		 	
Required			 
(		 
ErrorMessage		 
=		  
$str		! =
)		= >
]		> ?
public

 
string

 
Username

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
[ 	
Display	 
( 
Name 
= 
$str "
)" #
]# $
[ 	
Required	 
( 
ErrorMessage 
=  
$str! =
)= >
]> ?
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Display	 
( 
Name 
= 
$str %
)% &
]& '
public 
bool 

RememberMe 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
	ReturnUrl  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} Ñ
^C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\PackageTrackingViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public		 

class		 $
PackageTrackingViewModel		 )
{

 
public 
IEnumerable 
< 
Order  
>  !
?! "
Orders# )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
? 
SelectedCarrier &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? "
SelectedTrackingNumber -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} ∑
_C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ProductAddOrEditViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class %
ProductAddOrEditViewModel *
{ 
public		 
bool		 
AddsNew		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
Product

 
?

 
Product

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
IList 
< 
Category 
> 
ProductCategories 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
IList 
< 
Supplier 
> 
? 
	Suppliers  )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
} 
} É
]C:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ProductDetailsViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class #
ProductDetailsViewModel (
{ 
public		 
Product		 
Product		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
string

 
ProductImageUrl

 %
{

& '
get

( +
;

+ ,
set

- 0
;

0 1
}

2 3
public 
string 
? 
ErrorMessage #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
bool 
CanAddToCart  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Range	 
( 
$num 
, 
int 
. 
MaxValue 
, 
ErrorMessage  ,
=- .
$str/ M
)M N
]N O
[ 	
Required	 
] 
public 
short 
Quantity 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ›
ZC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\ProductListViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class  
ProductListViewModel %
{ 
public		 
IEnumerable		 
<		 
ProductItem		 &
>		& '
Products		( 0
{		1 2
get		3 6
;		6 7
set		8 ;
;		; <
}		= >
public

 
IEnumerable

 
<

 
Category

 #
>

# $
ProductCategories

% 6
{

7 8
get

9 <
;

< =
set

> A
;

A B
}

C D
public 
int 
? 
SelectedCategoryId &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 

NameFilter !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
class 
ProductItem  
{ 	
public 
Product 
Product "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
ImageUrl "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 	
} 
} ò%
WC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\RegisterViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
RegisterViewModel "
{ 
[ 	
Display	 
( 
Name 
= 
$str #
)# $
]$ %
[		 	
Required			 
(		 
ErrorMessage		 
=		  
$str		! >
)		> ?
]		? @
public

 
string

 
Username

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
[ 	
Display	 
( 
Name 
= 
$str  
)  !
]! "
[ 	
Required	 
( 
ErrorMessage 
=  
$str! B
)B C
]C D
[ 	
DataType	 
( 
DataType 
. 
EmailAddress '
)' (
]( )
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Display	 
( 
Name 
= 
$str &
)& '
]' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Display	 
( 
Name 
= 
$str "
)" #
]# $
[ 	
Required	 
( 
ErrorMessage 
=  
$str! =
)= >
]> ?
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Display	 
( 
Name 
= 
$str *
)* +
]+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! ?
)? @
]@ A
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
Compare	 
( 
nameof 
( 
Password  
)  !
,! "
ErrorMessage# /
=0 1
$str2 g
)g h
]h i
public 
string 
ConfirmedPassword '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[   	
Display  	 
(   
Name   
=   
$str   !
)  ! "
]  " #
public!! 
string!! 
?!! 
Address!! 
{!!  
get!!! $
;!!$ %
set!!& )
;!!) *
}!!+ ,
[## 	
Display##	 
(## 
Name## 
=## 
$str## 
)## 
]##  
public$$ 
string$$ 
?$$ 
City$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
[&& 	
Display&&	 
(&& 
Name&& 
=&& 
$str&& &
)&&& '
]&&' (
public'' 
string'' 
?'' 
Region'' 
{'' 
get''  #
;''# $
set''% (
;''( )
}''* +
[)) 	
Display))	 
()) 
Name)) 
=)) 
$str)) %
)))% &
]))& '
[** 	
DataType**	 
(** 
DataType** 
.** 

PostalCode** %
)**% &
]**& '
public++ 
string++ 
?++ 

PostalCode++ !
{++" #
get++$ '
;++' (
set++) ,
;++, -
}++. /
[-- 	
Display--	 
(-- 
Name-- 
=-- 
$str-- !
)--! "
]--" #
public.. 
string.. 
?.. 
Country.. 
{..  
get..! $
;..$ %
set..& )
;..) *
}..+ ,
}// 
}00 º
YC:\Users\mkn\Documents\GitHub\SoftwareSikkerhedsEksamen\ViewModels\StatusCodeViewModel.cs
	namespace 	
WebGoatCore
 
. 

ViewModels  
{ 
public 

class 
StatusCodeViewModel $
{ 
[ 	
Display	 
( 
Name 
= 
$str -
)- .
]. /
public 
int 
Code 
{ 
get 
; 
set "
;" #
}$ %
[		 	
Display			 
(		 
Name		 
=		 
$str		 "
)		" #
]		# $
public

 
string

 
Message

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
=

, -
$str

. 0
;

0 1
public 
static 
StatusCodeViewModel )
Create* 0
(0 1
ApiResponse1 <
response= E
)E F
{ 	
return 
new 
StatusCodeViewModel *
(* +
)+ ,
{- .
Code/ 3
=4 5
response6 >
.> ?

StatusCode? I
,I J
MessageK R
=S T
responseU ]
.] ^
Message^ e
}f g
;g h
} 	
} 
} 